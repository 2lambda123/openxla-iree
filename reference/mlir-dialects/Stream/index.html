
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://openxla.github.io/iree/reference/mlir-dialects/Stream/">
      
      
        <link rel="prev" href="../HALLoader/">
      
      
        <link rel="next" href="../Util/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.2.3">
    
    
      
        <title>Stream - IREE</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.0e669242.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto:300,300i,400,400i,700,700i%7CNoto+Sans+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Noto";--md-code-font:"Noto Sans Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../assets/stylesheets/openxla.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#stream-dialect" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      <!--
  Copyright (c) 2016-2023 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Determine classes -->


  


<!-- Header -->
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav
    class="md-header__inner md-grid"
    aria-label="Header"
  >

    <!-- Link to community home -->
    <a
      href="https://github.com/openxla/community"
      title="OpenXLA"
      class="md-header__button md-logo"
      aria-label="OpenXLA"
      data-md-component="logo"
    >
      
  <img src="../../../assets/images/openxla-logo-lockup-white.svg" alt="logo">

    </a>

    <!-- Link to site home -->
    <a
      href="https://openxla.github.io/iree/"
      title="IREE"
      class="md-header__button md-logo"
      aria-label="IREE"
      data-md-component="logo"
    >
    <div class="md-header__title">
      IREE
    </div>
    </a>

    <!-- Button to open drawer -->
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>

    <!-- Header title -->
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Stream
            
          </span>
        </div>
      </div>
    </div>

    <!-- Color palette -->
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input
              class="md-option"
              data-md-color-media="(prefers-color-scheme: light)"
              data-md-color-scheme="default"
              data-md-color-primary="indigo"
              data-md-color-accent="indigo"
              
                aria-label="Switch to dark mode"
              
              type="radio"
              name="__palette"
              id="__palette_1"
            />
            
              <label
                class="md-header__button md-icon"
                title="Switch to dark mode"
                for="__palette_2"
                hidden
              >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
            
            
            
            <input
              class="md-option"
              data-md-color-media="(prefers-color-scheme: dark)"
              data-md-color-scheme="slate"
              data-md-color-primary="indigo"
              data-md-color-accent="indigo"
              
                aria-label="Switch to light mode"
              
              type="radio"
              name="__palette"
              id="__palette_2"
            />
            
              <label
                class="md-header__button md-icon"
                title="Switch to light mode"
                for="__palette_1"
                hidden
              >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
        </form>
      
    

    <!-- Site language selector -->
    

    <!-- Button to open search modal -->
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>

      <!-- Search interface -->
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    

    <!-- Repository information -->
    
      <div class="md-header__source">
        <a href="https://github.com/openxla/iree" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    openxla/iree
  </div>
</a>
      </div>
    
  </nav>

  <!-- Navigation tabs (sticky) -->
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../building-from-source/" class="md-tabs__link">
          
  
    
  
  Building from source

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../guides/" class="md-tabs__link">
          
  
    
  
  Guides

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
    
  
  Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../community/" class="md-tabs__link">
          
  
    
  
  Community

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <!--
  Copyright (c) 2016-2023 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->



<!-- Determine classes -->


  



<!-- Navigation -->
<nav
  class="md-nav md-nav--primary md-nav--lifted"
  aria-label="Navigation"
  data-md-level="0"
>

  <!-- Community site logo / home page link -->
  <label class="md-nav__title" for="__drawer">
    <a
      href="https://github.com/openxla/community"
      title="IREE"
      class="md-nav__button md-logo"
      aria-label="IREE"
      data-md-component="logo"
    >
      
  <img src="../../../assets/images/openxla-logo-lockup-white.svg" alt="logo">

    </a>
    <!-- Site title (nav item below links to site home) -->
    IREE
  </label>

  <!-- Repository information -->
  
    <div class="md-nav__source">
      <a href="https://github.com/openxla/iree" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    openxla/iree
  </div>
</a>
    </div>
  

  <!-- Navigation list -->
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../building-from-source/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Building from source
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Building from source
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../building-from-source/getting-started/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3 2.75C3 1.784 3.784 1 4.75 1h6.5c.966 0 1.75.784 1.75 1.75v11.5a.75.75 0 0 1-1.227.579L8 11.722l-3.773 3.107A.751.751 0 0 1 3 14.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.91l3.023-2.489a.75.75 0 0 1 .954 0l3.023 2.49V2.75a.25.25 0 0 0-.25-.25Z"/></svg>
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../building-from-source/android/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.523 15.341a1 1 0 0 1 0-1.999 1 1 0 0 1 0 2m-11.046 0a1 1 0 0 1 0-2 1 1 0 0 1 0 2m11.405-6.02 1.997-3.46a.416.416 0 0 0-.152-.567.416.416 0 0 0-.568.152L17.137 8.95c-1.547-.706-3.284-1.1-5.137-1.1s-3.59.394-5.137 1.1L4.841 5.447a.416.416 0 0 0-.568-.152.416.416 0 0 0-.152.567l1.997 3.46C2.688 11.186.343 14.658 0 18.76h24c-.344-4.102-2.69-7.574-6.119-9.44"/></svg>
  
  <span class="md-ellipsis">
    Android cross-compilation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../building-from-source/ios/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12.152 6.896c-.948 0-2.415-1.078-3.96-1.04-2.04.027-3.91 1.183-4.961 3.014-2.117 3.675-.546 9.103 1.519 12.09 1.013 1.454 2.208 3.09 3.792 3.039 1.52-.065 2.09-.987 3.935-.987 1.831 0 2.35.987 3.96.948 1.637-.026 2.676-1.48 3.676-2.948 1.156-1.688 1.636-3.325 1.662-3.415-.039-.013-3.182-1.221-3.22-4.857-.026-3.04 2.48-4.494 2.597-4.559-1.429-2.09-3.623-2.324-4.39-2.376-2-.156-3.675 1.09-4.61 1.09zM15.53 3.83c.843-1.012 1.4-2.427 1.245-3.83-1.207.052-2.662.805-3.532 1.818-.78.896-1.454 2.338-1.273 3.714 1.338.104 2.715-.688 3.559-1.701"/></svg>
  
  <span class="md-ellipsis">
    iOS cross-compilation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../building-from-source/riscv/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M6.5.75V2h3V.75a.75.75 0 0 1 1.5 0V2h1.25c.966 0 1.75.784 1.75 1.75V5h1.25a.75.75 0 0 1 0 1.5H14v3h1.25a.75.75 0 0 1 0 1.5H14v1.25A1.75 1.75 0 0 1 12.25 14H11v1.25a.75.75 0 0 1-1.5 0V14h-3v1.25a.75.75 0 0 1-1.5 0V14H3.75A1.75 1.75 0 0 1 2 12.25V11H.75a.75.75 0 0 1 0-1.5H2v-3H.75a.75.75 0 0 1 0-1.5H2V3.75C2 2.784 2.784 2 3.75 2H5V.75a.75.75 0 0 1 1.5 0Zm5.75 11.75a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25ZM5.75 5h4.5a.75.75 0 0 1 .75.75v4.5a.75.75 0 0 1-.75.75h-4.5a.75.75 0 0 1-.75-.75v-4.5A.75.75 0 0 1 5.75 5Zm.75 4.5h3v-3h-3Z"/></svg>
  
  <span class="md-ellipsis">
    RISC-V cross-compilation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../guides/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Guides
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_3">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../guides/ml-frameworks/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ML frameworks
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_3_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            ML frameworks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/ml-frameworks/tensorflow/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M1.292 5.856 11.54 0v24l-4.095-2.378V7.603l-6.168 3.564.015-5.31zm21.43 5.311-.014-5.31L12.46 0v24l4.095-2.378V14.87l3.092 1.788-.018-4.618-3.074-1.756V7.603l6.168 3.564z"/></svg>
  
  <span class="md-ellipsis">
    TensorFlow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/ml-frameworks/tflite/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M1.292 5.856 11.54 0v24l-4.095-2.378V7.603l-6.168 3.564.015-5.31zm21.43 5.311-.014-5.31L12.46 0v24l4.095-2.378V14.87l3.092 1.788-.018-4.618-3.074-1.756V7.603l6.168 3.564z"/></svg>
  
  <span class="md-ellipsis">
    TensorFlow Lite
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/ml-frameworks/jax/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.25.18.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z"/></svg>
  
  <span class="md-ellipsis">
    JAX
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/ml-frameworks/pytorch/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12.005 0 4.952 7.053a9.865 9.865 0 0 0 0 14.022 9.866 9.866 0 0 0 14.022 0c3.984-3.9 3.986-10.205.085-14.023l-1.744 1.743c2.904 2.905 2.904 7.634 0 10.538s-7.634 2.904-10.538 0-2.904-7.634 0-10.538l4.647-4.646.582-.665zm3.568 3.899a1.327 1.327 0 0 0-1.327 1.327 1.327 1.327 0 0 0 1.327 1.328A1.327 1.327 0 0 0 16.9 5.226 1.327 1.327 0 0 0 15.573 3.9z"/></svg>
  
  <span class="md-ellipsis">
    PyTorch
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="Recently updated">
    </span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../guides/deployment-configurations/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Deployment configurations
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_3_3">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Deployment configurations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/deployment-configurations/cpu/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M6.5.75V2h3V.75a.75.75 0 0 1 1.5 0V2h1.25c.966 0 1.75.784 1.75 1.75V5h1.25a.75.75 0 0 1 0 1.5H14v3h1.25a.75.75 0 0 1 0 1.5H14v1.25A1.75 1.75 0 0 1 12.25 14H11v1.25a.75.75 0 0 1-1.5 0V14h-3v1.25a.75.75 0 0 1-1.5 0V14H3.75A1.75 1.75 0 0 1 2 12.25V11H.75a.75.75 0 0 1 0-1.5H2v-3H.75a.75.75 0 0 1 0-1.5H2V3.75C2 2.784 2.784 2 3.75 2H5V.75a.75.75 0 0 1 1.5 0Zm5.75 11.75a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25ZM5.75 5h4.5a.75.75 0 0 1 .75.75v4.5a.75.75 0 0 1-.75.75h-4.5a.75.75 0 0 1-.75-.75v-4.5A.75.75 0 0 1 5.75 5Zm.75 4.5h3v-3h-3Z"/></svg>
  
  <span class="md-ellipsis">
    CPU
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/deployment-configurations/bare-metal/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M6.5.75V2h3V.75a.75.75 0 0 1 1.5 0V2h1.25c.966 0 1.75.784 1.75 1.75V5h1.25a.75.75 0 0 1 0 1.5H14v3h1.25a.75.75 0 0 1 0 1.5H14v1.25A1.75 1.75 0 0 1 12.25 14H11v1.25a.75.75 0 0 1-1.5 0V14h-3v1.25a.75.75 0 0 1-1.5 0V14H3.75A1.75 1.75 0 0 1 2 12.25V11H.75a.75.75 0 0 1 0-1.5H2v-3H.75a.75.75 0 0 1 0-1.5H2V3.75C2 2.784 2.784 2 3.75 2H5V.75a.75.75 0 0 1 1.5 0Zm5.75 11.75a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25ZM5.75 5h4.5a.75.75 0 0 1 .75.75v4.5a.75.75 0 0 1-.75.75h-4.5a.75.75 0 0 1-.75-.75v-4.5A.75.75 0 0 1 5.75 5Zm.75 4.5h3v-3h-3Z"/></svg>
  
  <span class="md-ellipsis">
    CPU - Bare-Metal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/deployment-configurations/gpu-vulkan/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1.75 1h12.5c.966 0 1.75.784 1.75 1.75v4c0 .372-.116.717-.314 1 .198.283.314.628.314 1v4a1.75 1.75 0 0 1-1.75 1.75H1.75A1.75 1.75 0 0 1 0 12.75v-4c0-.358.109-.707.314-1a1.739 1.739 0 0 1-.314-1v-4C0 1.784.784 1 1.75 1ZM1.5 2.75v4c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-4a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25Zm.25 5.75a.25.25 0 0 0-.25.25v4c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-4a.25.25 0 0 0-.25-.25ZM7 4.75A.75.75 0 0 1 7.75 4h4.5a.75.75 0 0 1 0 1.5h-4.5A.75.75 0 0 1 7 4.75ZM7.75 10h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM3 4.75A.75.75 0 0 1 3.75 4h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 3 4.75ZM3.75 10h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1 0-1.5Z"/></svg>
  
  <span class="md-ellipsis">
    GPU - Vulkan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/deployment-configurations/gpu-cuda-rocm/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1.75 1h12.5c.966 0 1.75.784 1.75 1.75v4c0 .372-.116.717-.314 1 .198.283.314.628.314 1v4a1.75 1.75 0 0 1-1.75 1.75H1.75A1.75 1.75 0 0 1 0 12.75v-4c0-.358.109-.707.314-1a1.739 1.739 0 0 1-.314-1v-4C0 1.784.784 1 1.75 1ZM1.5 2.75v4c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-4a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25Zm.25 5.75a.25.25 0 0 0-.25.25v4c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-4a.25.25 0 0 0-.25-.25ZM7 4.75A.75.75 0 0 1 7.75 4h4.5a.75.75 0 0 1 0 1.5h-4.5A.75.75 0 0 1 7 4.75ZM7.75 10h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM3 4.75A.75.75 0 0 1 3.75 4h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 3 4.75ZM3.75 10h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1 0-1.5Z"/></svg>
  
  <span class="md-ellipsis">
    GPU - CUDA/ROCm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/deployment-configurations/gpu-metal/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12.152 6.896c-.948 0-2.415-1.078-3.96-1.04-2.04.027-3.91 1.183-4.961 3.014-2.117 3.675-.546 9.103 1.519 12.09 1.013 1.454 2.208 3.09 3.792 3.039 1.52-.065 2.09-.987 3.935-.987 1.831 0 2.35.987 3.96.948 1.637-.026 2.676-1.48 3.676-2.948 1.156-1.688 1.636-3.325 1.662-3.415-.039-.013-3.182-1.221-3.22-4.857-.026-3.04 2.48-4.494 2.597-4.559-1.429-2.09-3.623-2.324-4.39-2.376-2-.156-3.675 1.09-4.61 1.09zM15.53 3.83c.843-1.012 1.4-2.427 1.245-3.83-1.207.052-2.662.805-3.532 1.818-.78.896-1.454 2.338-1.273 3.714 1.338.104 2.715-.688 3.559-1.701"/></svg>
  
  <span class="md-ellipsis">
    GPU - Metal
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_4" >
        
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Other topics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Other topics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/developer-tips/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 6a6 6 0 0 1 6 6c0 2.22-1.21 4.16-3 5.2V19a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-1.8c-1.79-1.04-3-2.98-3-5.2a6 6 0 0 1 6-6m2 15v1a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-1h4m6-10h3v2h-3v-2M1 11h3v2H1v-2M13 1v3h-2V1h2M4.92 3.5l2.13 2.14-1.42 1.41L3.5 4.93 4.92 3.5m12.03 2.13 2.12-2.13 1.43 1.43-2.13 2.12-1.42-1.42Z"/></svg>
  
  <span class="md-ellipsis">
    Developer tips and tricks
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_4">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../bindings/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    API bindings
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_4_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            API bindings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../bindings/c-api/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="m11.28 3.22 4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L13.94 8l-3.72-3.72a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215Zm-6.56 0a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L2.06 8l3.72 3.72a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L.47 8.53a.75.75 0 0 1 0-1.06Z"/></svg>
  
  <span class="md-ellipsis">
    C API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../bindings/python/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.25.18.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z"/></svg>
  
  <span class="md-ellipsis">
    Python
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m20.83 2.978-.086.095a16.245 16.245 0 0 0-1.19 1.487 5.773 5.773 0 0 0-.446.719 2.88 2.88 0 0 0-.249.596.497.497 0 0 0-.033.177v.004a.297.297 0 0 0-.21.29.3.3 0 0 0 .187.284c.038.371.08 1.142.07 2.2l-.004.142a8.001 8.001 0 0 1-.434 2.327c-.016-.01-.03-.014-.04-.013-.03.003-.11.12-.19.251-.058.09-.119.195-.154.291a.37.37 0 0 0-.03.14.249.249 0 0 0 .01.088c.01.037.022.058.022.058a6.836 6.836 0 0 1-.003.007.144.144 0 0 0-.028.067l-.012.029a6.836 6.836 0 0 1-.257.527l-.077.142a6.836 6.836 0 0 1-.07.115.157.157 0 0 0-.022-.014.16.16 0 0 0-.113.024c-.047.035-.151.194-.498.368a1.384 1.384 0 0 1-.32.114 14.1 14.1 0 0 0 .248-2.07 5.072 5.072 0 0 0-.064-1.057c.003-.01.003-.017.003-.017l-.005.01a4.345 4.345 0 0 0-.104-.458 3.554 3.554 0 0 0-.724-1.385c-.631-.754-1.496-1.14-2.256-1.165l-.125-.002c0-.008 0-.015.002-.022.02-.098.024-.127-.087-.032a.872.872 0 0 0-.057.054 2.986 2.986 0 0 0-.146.007.716.716 0 0 1-.003-.108c.004-.076.024-.127-.087-.032a.553.553 0 0 0-.142.167c-.05.008-.08.015-.08.015l.045-.002-.047.008c-.016-.042-.053-.105-.048-.16.01-.118.043-.14-.037-.065-.098.09-.202.226-.22.3l-.096.03c-.018-.019-.074-.07-.086-.179-.013-.11-.012-.166-.08-.05a1.14 1.14 0 0 0-.13.348c-.032.015-.063.03-.093.046a.27.27 0 0 1-.057-.173c-.005-.144.04-.26-.067-.068a1.634 1.634 0 0 0-.146.406 1.6 1.6 0 0 0-.105.08 2.7 2.7 0 0 1-.008-.17c-.002-.143.021-.296-.067-.026a1.832 1.832 0 0 0-.07.321c-.404.385-.65.917-.644 1.572v.007a3.42 3.42 0 0 0 .014.33c.02.238.057.438.107.605-.095.13-.103.689-.01.818.073.104.496.35.586.399a.367.367 0 0 1 .094.093c.115.188.115.567.027.762-.107.238.107.285.285.32.178.036.415-.023.463-.118.047-.095-.154-.31-.237-.748-.084-.439.13-.474.13-.474s.095.024.237.249c.11.175.227.313.336.413a.727.727 0 0 1-.201.172c.12.005.24-.051.304-.087a.77.77 0 0 0 .07.045 1.015 1.015 0 0 1-.05.05.506.506 0 0 0 .109-.022.295.295 0 0 0 .084.022c.155.012.57-.368.57-.439 0-.018-.015-.04-.038-.063-.042-.045-.12-.1-.207-.177a1.03 1.03 0 0 1-.11-.116.723.723 0 0 1-.141-.374v-.01l-.003-.031s.007-.007.016-.02v.004l.004-.01c.052-.08.15-.379-.47-1.078a3.045 3.045 0 0 0-.924-.706c-.042-.472.15-.913.626-1.13l-.005.005.008-.006c.227-.102.517-.155.877-.136.69.036 1.22.36 1.59.845.514.712.738 1.78.575 2.856-.068.065-.055.075-.013.077a4.616 4.616 0 0 1-.055.273l-.027.015c-.123.074-.071.073 0 .092l-.006.02a3.98 3.98 0 0 1-.066.193.956.956 0 0 0-.087.03c-.135.053-.08.06-.012.09l.044.023a5.62 5.62 0 0 1-.101.237.746.746 0 0 0-.08.017c-.142.036-.088.05-.024.09a.52.52 0 0 1 .04.027 6.783 6.783 0 0 1-.107.214.76.76 0 0 0-.153.025c-.14.036-.087.05-.023.09.034.02.06.04.08.059a8.021 8.021 0 0 1-.094.165l-.023.036a.59.59 0 0 0-.206.024c-.142.036-.088.05-.024.09a.67.67 0 0 1 .104.079 8.61 8.61 0 0 1-.126.18.514.514 0 0 0-.23-.005c-.144.02-.092.04-.033.086.068.053.1.099.118.118l-.062.084c-.044-.058-.15-.124-.246-.193a.85.85 0 0 0-.29-.13c-.048 0-.2.268-1.017.197-.819-.071-.87-.15-.942-.15a.978.978 0 0 0-.228.059l-.034-.02a11.03 11.03 0 0 1-.972-.674c-.464-.37-.72-.647-.72-.647s.137-.125-.047-.284a3.32 3.32 0 0 0-.338-.277 2.157 2.157 0 0 0-.242-.166 3.57 3.57 0 0 1-.088-.127 11.485 11.485 0 0 1-.363-.628 10.455 10.455 0 0 1-.25-.527c-.16-.36-.27-.682-.346-.964a5.62 5.62 0 0 1-.148-.923 2.257 2.257 0 0 1 .004-.242.411.411 0 0 0 .158-.323.411.411 0 0 0-.358-.407c-.204-.427-.982-1.477-3.881-3.68l-.127-.097.005.004-.036-.027C7.067 6.599 7.644 7.587 7.795 8a.411.411 0 0 0-.027.033 18.69 18.69 0 0 0-.018-.013c.018 0 .025-.005.025-.005s-.672-.546-1.787-1.23c-1.118-.687-1.748-.849-1.88-.877l-.026-.006s.206.19.174.285c-.01.032-.168.022-.421.028a3.948 3.948 0 0 0-.725.07 4.1 4.1 0 0 0-1.567.63C.238 7.785 0 8.401 0 8.401s.55-.768 1.58-1.305c-.014.337-.047 1.97.445 4.12.53 2.32 1.53 4.487 1.614 4.665.004.178.016.272.016.272s.148-1.79.756-3.647c.175.283.758 1.117 2.075 2.096 1.628 1.21 2.37 1.536 2.4 1.548.001.157.005.24.005.24s.005-.1.018-.263a4.69 4.69 0 0 1 .552-.67 3.58 3.58 0 0 1 .54-.435c.032.11.063.204.093.276-.02-.097-.036-.19-.052-.282.107.01.538.066 1.206.393.343.168.609.395.798.595a.167.167 0 0 0-.014.006s.123.112.269.403a2.416 2.416 0 0 0-.73.084 2.913 2.913 0 0 0-.098-.19.484.484 0 0 0-.039-.134c-.027-.061-.095-.1-.164-.14a.397.397 0 0 0-.104-.073.225.225 0 0 1-.055-.073c-.084-.184-.798.012-.942.18-.175.204-.209.464-.14.608.021.045.07.082.138.11.002.22.137.75.404 1.133a4.964 4.964 0 0 1-.108-.666c-.009-.16 0-.274.015-.35.047.328.174.684.577 1.124-.248-.54-.22-.861-.195-1.143l.01-.044.005-.001c.036.263.142.534.482.963a.412.412 0 0 1-.014-.028l.014.021a1.626 1.626 0 0 1-.167-1.03l.008-.002c.046.03.091.07.134.126.128.172.188.349.212.47a.528.528 0 0 0 .067.383 18.33 18.33 0 0 1-.72.501c-.23.15-.49.313-.757.47-.14.08-.279.158-.414.23l-.135-.077h.002l-.008-.004c-.97-.559-1.69-.932-2.518-1.082-.93-.166-1.786.283-1.982 1.082a1.284 1.284 0 0 0 .552 1.38l.012.008c.013.01.026.017.04.026l.06.036h.002a2.1 2.1 0 0 0 .69.237l.028.005h.006a3.5 3.5 0 0 0 .412.044c.975.047 2.156-.408 3.323-.982.1.054.202.108.306.166 2.547 1.403 4.098 1.585 6.154.728-.502.151-1.208.356-2.094.344a.05.05 0 0 0-.02-.006v.006a5.46 5.46 0 0 1-.647-.05l-.03-.004v-.003a.267.267 0 0 0-.001.002 6.25 6.25 0 0 1-1.556-.436 7.792 7.792 0 0 1-.745-.362 57.065 57.065 0 0 1-1.006-.569c.348-.178.692-.363 1.026-.545.355-.189.672-.362.918-.5l.009-.004h.007s.083-.019.16-.043c.17-.052.41-.149.695-.283.028.117.095.215.195.253.235.091.407.027.522-.102l.018-.01.047-.037c.05-.03.107-.067.156-.09a1.14 1.14 0 0 1 .053-.022c.04-.01.078-.023.116-.037l.033-.01c-.145.297-.091.581-.091.581.043-.37.22-.608.392-.715.064-.027.13-.05.2-.067.064 0 .116.023.144.07.07.12.217.194.364.226.024.15-.045.404-.4.866l.09-.062.004-.003.072-.053c.143-.108.252-.21.334-.305a.97.97 0 0 0 .19-.305c.013.2-.042.507-.31 1.036 0 0 .317-.276.514-.63.006.191-.01.443-.063.785.345-.673.325-1.085.239-1.326l-.01-.036a.433.433 0 0 0-.01-.065l.042-.057c.118-.166-.048-.344-.154-.414-.06-.04-.2-.154-.454-.157-.225-.27-.51-.15-.958.145a1.297 1.297 0 0 1-.166.092.725.725 0 0 0-.055-.116c.16-.096.326-.2.494-.308.317-.207.553-.416.728-.615.51-.517.69-1.02 1.21-1.446h-.013l.06-.031c.854-.458 1.306-.547 1.338-.553l-.003.128.018-.125a1.795 1.795 0 0 1 .481.344 2.12 2.12 0 0 1 .362.487l.044.3s0-.116-.01-.33c.153-.151 1.02-1.043 1.724-2.466.694-1.404.944-2.523 1.017-2.924a18.188 18.188 0 0 1 .665 2.466s-.002-.133-.03-.374c.096-.336.515-1.872.626-3.756.1-1.68-.065-2.78-.14-3.173.648.536.995 1.306.995 1.306s-.04-.163-.188-.437l.02.027s-.236-.455-.644-.904a6.45 6.45 0 0 0-.157-.172c-.432-.46-.854-.617-1.17-.672a1.57 1.57 0 0 0-.308-.03h-.019c-.125-.003-.2.002-.207-.026-.02-.095.11-.285.11-.285s-.177.046-.554.33c-.23.167-.52.41-.853.76a13.689 13.689 0 0 0-.89.994l-.075.095a.203.203 0 0 0-.023-.017c.076-.33.362-1.117 1.788-3.111zM11.92 14.09a.351.351 0 0 1 .012.006zm-.263 2.606c.088.044.19.106.303.194h-.005a.484.484 0 0 0-.155.07.956.956 0 0 1-.126-.224zm-4.855 1.57c.132 0 .276.013.432.047l.02.005.017.004c.11.027.223.062.337.102l.057.021c.191.074.395.156.611.248.32.14.62.277.838.375l.183.088c-.22.106-.424.196-.577.261-1.014.416-1.83.536-2.338.391-.944-.269-.76-1.536.42-1.542z"/></svg>
  
  <span class="md-ellipsis">
    MLIR dialects
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_4_3">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            MLIR dialects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_2" checked>
        
          <label class="md-nav__link" for="__nav_4_3_2" id="__nav_4_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Internal dialects
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_3_2">
            <span class="md-nav__icon md-icon"></span>
            Internal dialects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Check/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Check
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../HAL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HAL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../HALInline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HALInline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../HALLoader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HALLoader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Stream
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Stream
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#operation-definition" class="md-nav__link">
    Operation definition
  </a>
  
    <nav class="md-nav" aria-label="Operation definition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#async-control-flow-ops" class="md-nav__link">
    Async control flow ops
  </a>
  
    <nav class="md-nav" aria-label="Async control flow ops">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#streamasynccall-streamasynccallop" class="md-nav__link">
    stream.async.call (Stream::AsyncCallOp)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../VM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../VMVX/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VMVX
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3_3" >
        
          <label class="md-nav__link" for="__nav_4_3_3" id="__nav_4_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Public dialects
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_3">
            <span class="md-nav__icon md-icon"></span>
            Public dialects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../IREEInput/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IREEInput
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../IREELinalgExt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IREELinalgExt
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4" >
        
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Other topics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Other topics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 1.75A.75.75 0 0 1 .75 1h4.253c1.227 0 2.317.59 3 1.501A3.743 3.743 0 0 1 11.006 1h4.245a.75.75 0 0 1 .75.75v10.5a.75.75 0 0 1-.75.75h-4.507a2.25 2.25 0 0 0-1.591.659l-.622.621a.75.75 0 0 1-1.06 0l-.622-.621A2.25 2.25 0 0 0 5.258 13H.75a.75.75 0 0 1-.75-.75Zm7.251 10.324.004-5.073-.002-2.253A2.25 2.25 0 0 0 5.003 2.5H1.5v9h3.757a3.75 3.75 0 0 1 1.994.574ZM8.755 4.75l-.004 7.322a3.752 3.752 0 0 1 1.992-.572H14.5v-9h-3.495a2.25 2.25 0 0 0-2.25 2.25Z"/></svg>
  
  <span class="md-ellipsis">
    Glossary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../optimization-options/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M14.064 0h.186C15.216 0 16 .784 16 1.75v.186a8.752 8.752 0 0 1-2.564 6.186l-.458.459c-.314.314-.641.616-.979.904v3.207c0 .608-.315 1.172-.833 1.49l-2.774 1.707a.749.749 0 0 1-1.11-.418l-.954-3.102a1.214 1.214 0 0 1-.145-.125L3.754 9.816a1.218 1.218 0 0 1-.124-.145L.528 8.717a.749.749 0 0 1-.418-1.11l1.71-2.774A1.748 1.748 0 0 1 3.31 4h3.204c.288-.338.59-.665.904-.979l.459-.458A8.749 8.749 0 0 1 14.064 0ZM8.938 3.623h-.002l-.458.458c-.76.76-1.437 1.598-2.02 2.5l-1.5 2.317 2.143 2.143 2.317-1.5c.902-.583 1.74-1.26 2.499-2.02l.459-.458a7.25 7.25 0 0 0 2.123-5.127V1.75a.25.25 0 0 0-.25-.25h-.186a7.249 7.249 0 0 0-5.125 2.123ZM3.56 14.56c-.732.732-2.334 1.045-3.005 1.148a.234.234 0 0 1-.201-.064.234.234 0 0 1-.064-.201c.103-.671.416-2.273 1.15-3.003a1.502 1.502 0 1 1 2.12 2.12Zm6.94-3.935c-.088.06-.177.118-.266.175l-2.35 1.521.548 1.783 1.949-1.2a.25.25 0 0 0 .119-.213ZM3.678 8.116 5.2 5.766c.058-.09.117-.178.176-.266H3.309a.25.25 0 0 0-.213.119l-1.2 1.95ZM12 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"/></svg>
  
  <span class="md-ellipsis">
    Optimization options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../extensions/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M8 0a8.2 8.2 0 0 1 .701.031C9.444.095 9.99.645 10.16 1.29l.288 1.107c.018.066.079.158.212.224.231.114.454.243.668.386.123.082.233.09.299.071l1.103-.303c.644-.176 1.392.021 1.82.63.27.385.506.792.704 1.218.315.675.111 1.422-.364 1.891l-.814.806c-.049.048-.098.147-.088.294.016.257.016.515 0 .772-.01.147.038.246.088.294l.814.806c.475.469.679 1.216.364 1.891a7.977 7.977 0 0 1-.704 1.217c-.428.61-1.176.807-1.82.63l-1.102-.302c-.067-.019-.177-.011-.3.071a5.909 5.909 0 0 1-.668.386c-.133.066-.194.158-.211.224l-.29 1.106c-.168.646-.715 1.196-1.458 1.26a8.006 8.006 0 0 1-1.402 0c-.743-.064-1.289-.614-1.458-1.26l-.289-1.106c-.018-.066-.079-.158-.212-.224a5.738 5.738 0 0 1-.668-.386c-.123-.082-.233-.09-.299-.071l-1.103.303c-.644.176-1.392-.021-1.82-.63a8.12 8.12 0 0 1-.704-1.218c-.315-.675-.111-1.422.363-1.891l.815-.806c.05-.048.098-.147.088-.294a6.214 6.214 0 0 1 0-.772c.01-.147-.038-.246-.088-.294l-.815-.806C.635 6.045.431 5.298.746 4.623a7.92 7.92 0 0 1 .704-1.217c.428-.61 1.176-.807 1.82-.63l1.102.302c.067.019.177.011.3-.071.214-.143.437-.272.668-.386.133-.066.194-.158.211-.224l.29-1.106C6.009.645 6.556.095 7.299.03 7.53.01 7.764 0 8 0Zm-.571 1.525c-.036.003-.108.036-.137.146l-.289 1.105c-.147.561-.549.967-.998 1.189-.173.086-.34.183-.5.29-.417.278-.97.423-1.529.27l-1.103-.303c-.109-.03-.175.016-.195.045-.22.312-.412.644-.573.99-.014.031-.021.11.059.19l.815.806c.411.406.562.957.53 1.456a4.709 4.709 0 0 0 0 .582c.032.499-.119 1.05-.53 1.456l-.815.806c-.081.08-.073.159-.059.19.162.346.353.677.573.989.02.03.085.076.195.046l1.102-.303c.56-.153 1.113-.008 1.53.27.161.107.328.204.501.29.447.222.85.629.997 1.189l.289 1.105c.029.109.101.143.137.146a6.6 6.6 0 0 0 1.142 0c.036-.003.108-.036.137-.146l.289-1.105c.147-.561.549-.967.998-1.189.173-.086.34-.183.5-.29.417-.278.97-.423 1.529-.27l1.103.303c.109.029.175-.016.195-.045.22-.313.411-.644.573-.99.014-.031.021-.11-.059-.19l-.815-.806c-.411-.406-.562-.957-.53-1.456a4.709 4.709 0 0 0 0-.582c-.032-.499.119-1.05.53-1.456l.815-.806c.081-.08.073-.159.059-.19a6.464 6.464 0 0 0-.573-.989c-.02-.03-.085-.076-.195-.046l-1.102.303c-.56.153-1.113.008-1.53-.27a4.44 4.44 0 0 0-.501-.29c-.447-.222-.85-.629-.997-1.189l-.289-1.105c-.029-.11-.101-.143-.137-.146a6.6 6.6 0 0 0-1.142 0ZM11 8a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM9.5 8a1.5 1.5 0 1 0-3.001.001A1.5 1.5 0 0 0 9.5 8Z"/></svg>
  
  <span class="md-ellipsis">
    Extensions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../community/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Community
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_5">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Community
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../community/blog/" class="md-nav__link ">
              
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 1.75A.75.75 0 0 1 .75 1h4.253c1.227 0 2.317.59 3 1.501A3.743 3.743 0 0 1 11.006 1h4.245a.75.75 0 0 1 .75.75v10.5a.75.75 0 0 1-.75.75h-4.507a2.25 2.25 0 0 0-1.591.659l-.622.621a.75.75 0 0 1-1.06 0l-.622-.621A2.25 2.25 0 0 0 5.258 13H.75a.75.75 0 0 1-.75-.75Zm7.251 10.324.004-5.073-.002-2.253A2.25 2.25 0 0 0 5.003 2.5H1.5v9h3.757a3.75 3.75 0 0 1 1.994.574ZM8.755 4.75l-.004 7.322a3.752 3.752 0 0 1 1.992-.572H14.5v-9h-3.495a2.25 2.25 0 0 0-2.25 2.25Z"/></svg>
  
  <span class="md-ellipsis">
    Blog
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_5_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2_2" >
        
          <label class="md-nav__link" for="__nav_5_2_2" id="__nav_5_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Archive
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../community/blog/archive/2021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2021
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2_3" >
        
          <label class="md-nav__link" for="__nav_5_2_3" id="__nav_5_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Categories
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../community/blog/category/platforms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Platforms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../community/blog/category/performance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Performance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../community/blog/category/frontends/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Frontends
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../community/tags/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"/></svg>
  
  <span class="md-ellipsis">
    Tags
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#operation-definition" class="md-nav__link">
    Operation definition
  </a>
  
    <nav class="md-nav" aria-label="Operation definition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#async-control-flow-ops" class="md-nav__link">
    Async control flow ops
  </a>
  
    <nav class="md-nav" aria-label="Async control flow ops">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#streamasynccall-streamasynccallop" class="md-nav__link">
    stream.async.call (Stream::AsyncCallOp)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<!-- Autogenerated by mlir-tblgen; don't manually edit -->
<h1 id="stream-dialect">'stream' Dialect<a class="headerlink" href="#stream-dialect" title="Permanent link">link</a></h1>
<p>A dialect designed to model execution partitioning and scheduling.</p>
<p>The stream dialect is designed to take tensor programs and convert them to
explicitly scheduled asynchronous programs. This includes placing ops on
specific targets, partitioning the work between the targets, scheduling the
work for concurrency, and encoding tensors into target-specific resources.</p>
<div class="highlight"><pre><span></span><code>+--------+    +----------+    +-------+
| flow.* | -&gt; | stream.* | -&gt; | hal.* |
+--------+    +----------+    +-------+
</code></pre></div>
<p>This sits in-between the <code>flow</code> and <code>hal</code> dialects.</p>
<ul>
<li>
<p><code>flow</code> models tensor programs by separating work into dispatchable
  functions in order to isolate the main host program data flow and the
  dense tensor compute operations.</p>
</li>
<li>
<p><code>stream</code> models explicitly scheduled asynchronous programs by partitioning
  the dispatchable work, specifying target affinities, encoding tensors into
  target-specific forms, and scheduling the work to run concurrently.</p>
</li>
<li>
<p><code>hal</code> models a low-level hardware abstraction layer used to manage
  buffers and issue asynchronous work across a variety of device types. The
  dialect is largely 1:1 with the IREE HAL C API.</p>
</li>
</ul>
<p>Transforms in the dialect lower tensor values into opaque resources with the
goal of ensuring no tensors survive in the IR. At entry <code>stream.tensor.*</code>
ops are used to capture the source tensor encoding information (data type,
shapes, etc) and then lowered into <code>stream.async.*</code> ops that model the
asynchronous workloads on the opaque resources. The asynchronous operations
are then partitioned, allocated, and scheduled for execution using the
<code>stream.cmd.*</code> ops.</p>
<p>It's intended that after transformation through the stream dialect the
program is ready for execution on an abstract machine. At this level of
representation buffers have still not been allocated and devices are not
yet resolved, however the information captured in the <code>stream</code> IR allows
such operations to be done trivially. To this end all ops carry the symbolic
size of the resources on which they operate as well as the lifetime of the
resources they are acting upon. This manifests in the usage of the
<code>!stream.resource</code> type:</p>
<div class="highlight"><pre><span></span><code>// Unresolved lifetime (resolved during the iree-stream-refine-usage pass):
!stream.resource&lt;*&gt;
// An externally managed value (passed in via the program API).
!stream.resource&lt;external&gt;
// A staging buffer for uploads/downloads.
!stream.resource&lt;staging&gt;
// A short-lived value that is used across streams.
!stream.resource&lt;transient&gt;
// A long-lived value that persists across streams in globals.
!stream.resource&lt;variable&gt;
// An immutable value that persists for the duration of the program.
!stream.resource&lt;constant&gt;
</code></pre></div>
<p>Operations using resources carry the size of all operand result resources:</p>
<div class="highlight"><pre><span></span><code>// %update (40 bytes) is being inserted into %target (296 bytes).
// Can be dynamic values such as those originating from dynamic dimensions.
%13 = stream.async.update %update, %target[%c256 to %c296] :
    !stream.resource&lt;transient&gt;{%c40} -&gt;
    %target as !stream.resource&lt;transient&gt;{%c296}
</code></pre></div>
<p>Once all <code>stream.async.*</code> work is moved into executable regions (such as
<code>stream.async.execute</code>) <code>!stream.timepoint</code> values are used to sequence
the execution. These timepoints represent some point in time where all
execution up to that timepoint has completed and any results that were
produced by the execution are available for use. Attempting to use the
resources before their corresponding timepoint has been reached will lead
to undefined behavior. The benefit of this is that after timepoints are
established in the IR it's possible to induce aliasing of resources without
breaking execution correctness.</p>
<div class="toc">
<ul>
<li><a href="#stream-dialect">'stream' Dialect</a><ul>
<li><a href="#operation-definition">Operation definition</a><ul>
<li><a href="#async-control-flow-ops">Async control flow ops</a><ul>
<li><a href="#streamasynccall-streamasynccallop">stream.async.call (Stream::AsyncCallOp)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h2 id="operation-definition">Operation definition<a class="headerlink" href="#operation-definition" title="Permanent link">link</a></h2>
<h3 id="async-control-flow-ops">Async control flow ops<a class="headerlink" href="#async-control-flow-ops" title="Permanent link">link</a></h3>
<h4 id="streamasynccall-streamasynccallop"><code>stream.async.call</code> (Stream::AsyncCallOp)<a class="headerlink" href="#streamasynccall-streamasynccallop" title="Permanent link">link</a></h4>
<p><em>Calls a streamable external host function</em></p>
<p>Syntax:</p>
<div class="highlight"><pre><span></span><code>operation ::= `stream.async.call` (`on` `(` $affinity^ `)`)?
              $callee ``
              custom&lt;DispatchOperands&gt;($resource_operands,
              $resource_operand_offsets,
              $resource_operand_ends,
              $resource_operand_lengths) attr-dict `:`
              custom&lt;ShapedFunctionType&gt;(ref($resource_operands),
              type($resource_operands), $resource_operand_sizes,
              type($results), $result_sizes,
              $tied_operands)
</code></pre></div>
<p>Calls a function taking/returning resource values with stream semantics.
Asynchronous calls must have no side-effects.</p>
<p>Note that returned resources must have their sizes declared prior to the
call as this is what allows the call to be made on the stream. If external
host logic is required to compute the size (avoid at all costs!) a separate
func.call can be used outside of the stream to do so. If sizes are
unknownable until the operation is performed it should be made as a normal
asynchronous host call with 'coarse-fences' instead.</p>
<p>Traits: AttrSizedOperandSegments, Stream_AsyncPhaseOp</p>
<p>Interfaces: AsyncAccessOpInterface, CallOpInterface, Stream_AffinityOp, Stream_StreamableOp, SymbolUserOpInterface, TiedOpInterface, Util_SizeAwareOp</p>
<h5 id="attributes">Attributes:<a class="headerlink" href="#attributes" title="Permanent link">link</a></h5>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>callee</code></td><td>::mlir::FlatSymbolRefAttr</td><td>flat symbol reference attribute</td></tr>
<tr><td><code>tied_operands</code></td><td>::mlir::ArrayAttr</td><td>64-bit integer array attribute</td></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `resource_operands` | resource or external resource or transient resource or variable resource or constant resource or index or integer or floating-point or complex-type or any type
| `resource_operand_sizes` | index
| `resource_operand_offsets` | index
| `resource_operand_ends` | index
| `resource_operand_lengths` | index
| `result_sizes` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `results` | resource or external resource or transient resource or variable resource or constant resource or index or integer or floating-point or complex-type

#### `stream.async.concurrent` (Stream::AsyncConcurrentOp)

_Executes all ops concurrently_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.async.concurrent` (`on` `(` $affinity^ `)`)?
              `with` ``
              custom&lt;ResourceRegion&gt;($resource_operands,
              type($resource_operands), $resource_operand_sizes,
              type($results), $result_sizes,
              $tied_operands, $body)
              attr-dict-with-keyword
</code></pre></div>

Represents a wave of work scheduled concurrently (each op executing at the
same time). All resource inputs must be captured explicitly. All results are
only ready once all nested ops complete execution.

Waves can be nested to create a DAG. For example, take the following graph:
<div class="highlight"><pre><span></span><code>                  |
        v---------+---------v
+-------|-------+   +-------|-------+
|    v--+--v    |   |    v--+--v    |
| +----+ +----+ |   | +----+ +----+ |
| | %a | | %b | |   | | %c | | %d | |
| +----+ +----+ |   | +----+ +----+ |
|    +--v--+    |   |    +--v--+    |
+-------|-------+   +-------|-------+
        +---------v---------+
                  |
</code></pre></div>

Represented with nested waves:
<div class="highlight"><pre><span></span><code>  %0 = stream.async.concurrent with(%arg) -&gt; ... {
    %1 = stream.async.concurrent with(%arg as %arg0) -&gt; ... {
      %a = ...
      %b = ...
      stream.yield %a, %b
    }
    %2 = stream.async.concurrent with(%arg as %arg1) -&gt; ... {
      %c = ...
      %d = ...
      stream.yield %c, %d
    }
    stream.yield %1, %2
  }
</code></pre></div>

Traits: AttrSizedOperandSegments, HasParent<IREE::Stream::AsyncExecuteOp, IREE::Stream::AsyncConcurrentOp>, RecursiveMemoryEffects, SingleBlock, SingleBlockImplicitTerminator<IREE::Stream::YieldOp>, Stream_AsyncPhaseOp

Interfaces: AsyncAccessOpInterface, ClosureOpInterface, RegionBranchOpInterface, Stream_AffinityOp, Stream_StreamableOp, TiedOpInterface, Util_SizeAwareOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>tied_operands</code></td><td>::mlir::ArrayAttr</td><td>64-bit integer array attribute</td></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `resource_operands` | resource or external resource or transient resource or variable resource or constant resource or staging resource
| `resource_operand_sizes` | index
| `result_sizes` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `results` | resource or external resource or transient resource or variable resource or constant resource or staging resource

#### `stream.async.execute` (Stream::AsyncExecuteOp)

_Executes a dependency-aware sequence of streamable ops_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.async.execute` (`on` `(` $affinity^ `)`)?
              (`await` `(` $await_timepoint^ `)` `=` `` `&gt;`)?
              `with` ``
              custom&lt;ResourceRegion&gt;($resource_operands,
              type($resource_operands), $resource_operand_sizes,
              type($results), $result_sizes,
              $tied_operands, $body)
              `=` `` `&gt;` type($result_timepoint)
              attr-dict-with-keyword
</code></pre></div>

Evaluates the operations within the region by dependency order while obeying
ties when present. Nested ops execute serially in block order and nested
`stream.async.concurrent` ops can be used to run multiple ops concurrently
within the stream. All resource inputs must be captured explicitly. All
results are only ready once all nested ops complete execution and the
returned timepoint is reached. Zero or more timepoints may be provided to
block execution until they are all reached; zero timepoints indicates that
execution may begin immediately.

Traits: AttrSizedOperandSegments, RecursiveMemoryEffects, SingleBlock, SingleBlockImplicitTerminator<IREE::Stream::YieldOp>, Stream_AsyncPhaseOp

Interfaces: AsyncAccessOpInterface, ClosureOpInterface, RegionBranchOpInterface, Stream_AffinityOp, Stream_TimelineOp, TiedOpInterface, Util_SizeAwareOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>tied_operands</code></td><td>::mlir::ArrayAttr</td><td>64-bit integer array attribute</td></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `resource_operands` | resource or external resource or transient resource or variable resource or constant resource or staging resource
| `resource_operand_sizes` | index
| `result_sizes` | index
| `await_timepoint` | a timepoint indicating execution availability

##### Results:

| Result | Description |
| :----: | ----------- |
| `results` | resource or external resource or transient resource or variable resource or constant resource or staging resource
| `result_timepoint` | a timepoint indicating execution availability

#### `stream.async.func` (Stream::AsyncFuncOp)

_Streamable function declaration_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.async.func` custom&lt;SymbolVisibility&gt;($sym_visibility)
              $sym_name
              ``
              custom&lt;ShapedFunctionSignature&gt;($function_type,
              $tied_operands,
              $arg_attrs,
              $res_attrs)
              attr-dict-with-keyword
              ($body^)?
</code></pre></div>

Declares a function that can be called as an asynchronous streaming
operation via `stream.async.call`. Today only external functions are
allowed.

Traits: IsolatedFromAbove, Stream_AsyncPhaseOp

Interfaces: CallableOpInterface, FunctionOpInterface, Symbol

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>sym_name</code></td><td>::mlir::StringAttr</td><td>string attribute</td></tr>
<tr><td><code>function_type</code></td><td>::mlir::TypeAttr</td><td>type attribute of function type</td></tr>
<tr><td><code>tied_operands</code></td><td>::mlir::ArrayAttr</td><td>64-bit integer array attribute</td></tr>
<tr><td><code>sym_visibility</code></td><td>::mlir::StringAttr</td><td>string attribute</td></tr>
<tr><td><code>arg_attrs</code></td><td>::mlir::ArrayAttr</td><td>Array of dictionary attributes</td></tr>
<tr><td><code>res_attrs</code></td><td>::mlir::ArrayAttr</td><td>Array of dictionary attributes</td></tr>
<table>


### Channel ops



#### `stream.channel.count` (Stream::ChannelCountOp)

_Returns the total number of participants in the group_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.channel.count` $channel `:` type($result)
              attr-dict-with-keyword
</code></pre></div>

Returns the total participant count in the collective communicator group.

Traits: AlwaysSpeculatableImplTrait

Interfaces: ConditionallySpeculatable, InferTypeOpInterface, NoMemoryEffect (MemoryEffectOpInterface), OpAsmOpInterface

Effects: MemoryEffects::Effect{}

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `channel` | a collective communication channel

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | index

#### `stream.channel.create` (Stream::ChannelCreateOp)

_Creates a new channel for collective communication_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.channel.create` (`on` `(` $affinity^ `)`)?
              (`id` `(` $id^ `)`)?
              (`group` `(` $group^ `)`)?
              (`rank` `(` $rank^ `)`)?
              (`count` `(` $count^ `)`)?
              `:` type($result)
              attr-dict-with-keyword
</code></pre></div>

Returns a new channel with the given rank associated with the specified
affinity. Collective operations using this channel must only be submitted on
compatible affinities.

The group and ID are optional and may be null. The rank and count can be
omitted to indicate a default inherited from the environment or device
configuration at runtime.

Traits: AlwaysSpeculatableImplTrait, AttrSizedOperandSegments

Interfaces: ConditionallySpeculatable, InferTypeOpInterface, NoMemoryEffect (MemoryEffectOpInterface), OpAsmOpInterface, Stream_AffinityOp

Effects: MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>group</code></td><td>::mlir::StringAttr</td><td>string attribute</td></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `id` | a reference counted byte buffer
| `rank` | index
| `count` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | a collective communication channel

#### `stream.channel.rank` (Stream::ChannelRankOp)

_Returns the rank of the local participant in the group_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.channel.rank` $channel `:` type($result)
              attr-dict-with-keyword
</code></pre></div>

Returns the rank the channel represents as a participant in a collective
group in `[0, count)`.

Traits: AlwaysSpeculatableImplTrait

Interfaces: ConditionallySpeculatable, InferTypeOpInterface, NoMemoryEffect (MemoryEffectOpInterface), OpAsmOpInterface

Effects: MemoryEffects::Effect{}

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `channel` | a collective communication channel

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | index

#### `stream.channel.split` (Stream::ChannelSplitOp)

_Splits a collective communication channel_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.channel.split` $channel `,` $color `,` $key
              `:` type($channel) `-&gt;` type($result)
              attr-dict-with-keyword
</code></pre></div>

Partitions the group associated with the given channel into disjoint
subgroups for each unique value of color. Each new subgroup contains all
participants of the same color and within each subgroup the key argument
is used to define the rank order. When multiple participants in a group
use the same key the tie will be broken using their rank in the parent
group. A color of -1 indicates that the rank does not participate in any
subgroup and will return a null channel.

Traits: AlwaysSpeculatableImplTrait

Interfaces: ConditionallySpeculatable, InferTypeOpInterface, NoMemoryEffect (MemoryEffectOpInterface), OpAsmOpInterface

Effects: MemoryEffects::Effect{}

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `channel` | a collective communication channel
| `color` | index
| `key` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | a collective communication channel


### Executable ops



#### `stream.binding.subspan` (Stream::BindingSubspanOp)

_Returns an alias to a subspan of interface binding data_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.binding.subspan` $binding `` `[` $byte_offset `]`
              attr-dict `:` type($binding) `-&gt;` type($result) (`{` $dynamic_dims^ `}`)?
</code></pre></div>

Returns a subview to a tensor or memref-like type from a binding. The same
binding may have multiple subviews at different byte offsets.

Traits: AlwaysSpeculatableImplTrait

Interfaces: ConditionallySpeculatable, NoMemoryEffect (MemoryEffectOpInterface), Util_ShapeAwareOp

Effects: MemoryEffects::Effect{}

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `binding` | a managed resource binding into an executable scope
| `byte_offset` | index
| `dynamic_dims` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | any type

#### `stream.executable.end` (Stream::ExecutableEndOp)

_Terminator pseudo-op for the executable op_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.executable.end` attr-dict
</code></pre></div>


Traits: HasParent<IREE::Stream::ExecutableOp>, Terminator

#### `stream.executable.export` (Stream::ExecutableExportOp)

_Defines an executable entry point for dispatch operations_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.executable.export` custom&lt;SymbolVisibility&gt;($sym_visibility)
              custom&lt;SymbolAlias&gt;($sym_name, $function_ref)
              custom&lt;WorkgroupCountRegion&gt;($workgroup_count)
              attr-dict-with-keyword
</code></pre></div>

Specifies an exported function with an externally-visible alias. Multiple
exports can reference the same internal function.

Each entry point can have a unique workgroup count calculation region.
This region takes the workload parameters passed to each flow.dispatch and
produces an XYZ workgroup count for the 3D grid dispatch.

Traits: HasParent<IREE::Stream::ExecutableOp>, IsolatedFromAbove

Interfaces: Symbol

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>sym_visibility</code></td><td>::mlir::StringAttr</td><td>string attribute</td></tr>
<tr><td><code>sym_name</code></td><td>::mlir::StringAttr</td><td>string attribute</td></tr>
<tr><td><code>function_ref</code></td><td>::mlir::FlatSymbolRefAttr</td><td>flat symbol reference attribute</td></tr>
<table>

#### `stream.executable` (Stream::ExecutableOp)

_Generic executable module_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.executable` custom&lt;SymbolVisibility&gt;($sym_visibility)
              $sym_name
              attr-dict-with-keyword
              regions
</code></pre></div>

An executable module containing one or more public functions. The contents
of the functions are safe to dispatch and can be lowered further to
target-specific backend IR representations.

Traits: IsolatedFromAbove, SingleBlock, SingleBlockImplicitTerminator<IREE::Stream::ExecutableEndOp>, SymbolTable

Interfaces: Symbol

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>sym_visibility</code></td><td>::mlir::StringAttr</td><td>string attribute</td></tr>
<tr><td><code>sym_name</code></td><td>::mlir::StringAttr</td><td>string attribute</td></tr>
<table>


### Explicit command ops



#### `stream.cmd.call` (Stream::CmdCallOp)

_Calls a streamable external host function_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.cmd.call` $callee ``
              custom&lt;CmdCallOperands&gt;($resource_operands,
              $resource_operand_offsets,
              $resource_operand_lengths,
              $resource_operand_accesses) attr-dict `:`
              custom&lt;ShapedFunctionType&gt;(ref($resource_operands),
              type($resource_operands),
              $resource_operand_sizes,
              type($results),
              $result_sizes,
              $tied_operands)
</code></pre></div>

Calls a function operating on resource values with stream semantics.
Asynchronous calls must have no side-effects.

Traits: AttrSizedOperandSegments, Stream_CmdPhaseOp

Interfaces: CallOpInterface, Stream_StreamableOp, Stream_SubviewEffectOp, SymbolUserOpInterface, Util_SizeAwareOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>callee</code></td><td>::mlir::FlatSymbolRefAttr</td><td>flat symbol reference attribute</td></tr>
<tr><td><code>tied_operands</code></td><td>::mlir::ArrayAttr</td><td>64-bit integer array attribute</td></tr>
<tr><td><code>resource_operand_accesses</code></td><td>::mlir::ArrayAttr</td><td>access array attribute</td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `resource_operands` | index or integer or floating-point or complex-type or resource or external resource or transient resource or variable resource or constant resource or any type
| `resource_operand_sizes` | index
| `resource_operand_offsets` | index
| `resource_operand_lengths` | index
| `result_sizes` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `results` | index or integer or floating-point or complex-type

#### `stream.cmd.collective` (Stream::CmdCollectiveOp)

_Dispatches a collective operation_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.cmd.collective` `` $op `` `[` $element_count `]`
              `channel` `(` $channel `)`
              (`param` `(` $param^ `:` type($param) `)`)? `{`
              custom&lt;DispatchResources&gt;($resources, type($resources), $resource_sizes,
              $resource_offsets, $resource_lengths,
              $resource_accesses)
              `\n` `}`
              attr-dict-with-keyword
</code></pre></div>

Dispatches a collective operation specified against the device. If grouped
with other collectives in a `stream.cmd.concurrent` region the collective
operations may fuse and execute more efficiently.

Traits: AttrSizedOperandSegments, Stream_CmdPhaseOp

Interfaces: Stream_StreamableOp, Stream_SubviewEffectOp, Util_SizeAwareOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>op</code></td><td>::mlir::iree_compiler::IREE::Stream::CollectiveAttr</td><td><details><summary>collective operation and specification</summary>{{% markdown %}}
    Specifies the collective operation to perform and any mode bits required.
  {{% /markdown %}}</details></td></tr>
<tr><td><code>resource_accesses</code></td><td>::mlir::ArrayAttr</td><td>access array attribute</td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `channel` | a collective communication channel
| `element_count` | index
| `param` | 32-bit signless integer
| `resources` | resource or external resource or transient resource or variable resource or constant resource
| `resource_sizes` | index
| `resource_offsets` | index
| `resource_lengths` | index

#### `stream.cmd.concurrent` (Stream::CmdConcurrentOp)

_Executes all ops concurrently_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.cmd.concurrent` $body
              attr-dict-with-keyword
</code></pre></div>

Represents a wave of work scheduled concurrently (each op executing at the
same time).

Waves can be nested to create a DAG. For example, take the following graph:
<div class="highlight"><pre><span></span><code>                  |
        v---------+---------v
+-------|-------+   +-------|-------+
|    v--+--v    |   |    v--+--v    |
| +----+ +----+ |   | +----+ +----+ |
| | @a | | @b | |   | | @c | | @d | |
| +----+ +----+ |   | +----+ +----+ |
|    +--v--+    |   |    +--v--+    |
+-------|-------+   +-------|-------+
        +---------v---------+
                  |
</code></pre></div>

Represented with nested waves:
<div class="highlight"><pre><span></span><code>  stream.cmd.concurrent {
    stream.cmd.concurrent {
      stream.cmd.dispatch @a
      stream.cmd.dispatch @b
    }
    stream.cmd.concurrent {
      stream.cmd.dispatch @c
      stream.cmd.dispatch @d
    }
  }
</code></pre></div>

Traits: HasParent<IREE::Stream::CmdExecuteOp, IREE::Stream::CmdSerialOp, IREE::Stream::CmdConcurrentOp>, RecursiveMemoryEffects, SingleBlock, SingleBlockImplicitTerminator<IREE::Stream::YieldOp>, Stream_CmdPhaseOp

Interfaces: RegionBranchOpInterface, Stream_StreamableOp

#### `stream.cmd.copy` (Stream::CmdCopyOp)

_Copies a subview of a stream resource to another_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.cmd.copy` $source `[` $source_offset `]` `,`
              $target `[` $target_offset `]` `,`
              $length `:`
              type($source) `` `{` $source_size `}` `-&gt;`
              type($target) `` `{` $target_size `}`
              attr-dict-with-keyword
</code></pre></div>

Copies a subview of a resource into a subview of another.
As with memcpy this does not support overlapping updates into the same
resource.

Traits: Stream_CmdPhaseOp

Interfaces: Stream_StreamableOp, Stream_SubviewEffectOp, Util_SizeAwareOp

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `source` | any stream-compatible type
| `source_size` | index
| `source_offset` | index
| `target` | any stream-compatible type
| `target_size` | index
| `target_offset` | index
| `length` | index

#### `stream.cmd.discard` (Stream::CmdDiscardOp)

_Discards a subview of a resource_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.cmd.discard` $target `[` $target_offset `for` $target_length `]` `:`
              type($target) `` `{` $target_size `}`
              attr-dict-with-keyword
</code></pre></div>

Discards a subview of a resource, indicating that after this command the
specified contents are no longer needed. This can be used to trim memory
or invalidate caches.

Traits: Stream_CmdPhaseOp

Interfaces: Stream_StreamableOp, Stream_SubviewEffectOp, Util_SizeAwareOp

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `target` | any stream-compatible type
| `target_size` | index
| `target_offset` | index
| `target_length` | index

#### `stream.cmd.dispatch` (Stream::CmdDispatchOp)

_Dispatches a parallelized grid of work_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.cmd.dispatch` custom&lt;DispatchEntryPoints&gt;($entry_points)
              (`[` $workload^ `]`)? ``
              (`(` $uniform_operands^ `:` type($uniform_operands) `)`)? `{`
              custom&lt;DispatchResources&gt;($resources, type($resources), $resource_sizes,
              $resource_offsets, $resource_lengths,
              $resource_accesses)
              `\n` `}`
              attr-dict-with-keyword
</code></pre></div>

Calls the specified entry point function once for each element in the
specified workgroup count. Each workgroup has access to the same operands
and results and is able to load/store at will.

Traits: AttrSizedOperandSegments, Stream_CmdPhaseOp

Interfaces: Stream_StreamableOp, Stream_SubviewEffectOp, SymbolUserOpInterface, Util_SizeAwareOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>entry_points</code></td><td>::mlir::ArrayAttr</td><td>symbol ref array attribute</td></tr>
<tr><td><code>resource_accesses</code></td><td>::mlir::ArrayAttr</td><td>access array attribute</td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `workload` | index
| `uniform_operands` | index or integer or floating-point or complex-type
| `resources` | resource or external resource or transient resource or variable resource or constant resource
| `resource_sizes` | index
| `resource_offsets` | index
| `resource_lengths` | index

#### `stream.cmd.execute` (Stream::CmdExecuteOp)

_Executes a dependency-aware sequence of streamable ops_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.cmd.execute` (`on` `(` $affinity^ `)`)?
              (`await` `(` $await_timepoint^ `)` `=` `` `&gt;`)?
              `with` ``
              custom&lt;ExplicitResourceRegion&gt;($resource_operands,
              type($resource_operands), $resource_operand_sizes,
              $body)
              `=` `` `&gt;` type($result_timepoint)
              attr-dict-with-keyword
</code></pre></div>

Evaluates the operations within the region by dependency order while obeying
ties when present. Nested ops execute serially in block order and nested
`stream.cmd.concurrent` ops can be used to run multiple ops concurrently
within the stream. All resource inputs must be captured explicitly. All
results are only ready once all nested ops complete execution and the
returned timepoint is reached. Zero or more timepoints may be provided to
block execution until they are all reached; zero timepoints indicates that
execution may begin immediately.

Traits: AttrSizedOperandSegments, RecursiveMemoryEffects, SingleBlock, SingleBlockImplicitTerminator<IREE::Stream::YieldOp>, Stream_CmdPhaseOp

Interfaces: ClosureOpInterface, InferTypeOpInterface, RegionBranchOpInterface, Stream_AffinityOp, Stream_TimelineOp, Util_SizeAwareOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `resource_operands` | resource or external resource or transient resource or variable resource or constant resource or staging resource
| `resource_operand_sizes` | index
| `await_timepoint` | a timepoint indicating execution availability

##### Results:

| Result | Description |
| :----: | ----------- |
| `result_timepoint` | a timepoint indicating execution availability

#### `stream.cmd.fill` (Stream::CmdFillOp)

_Fills a subview of a stream resource with a value_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.cmd.fill` $value `,`
              $target `[` $target_offset `for` $target_length `]` `:`
              type($value) `-&gt;`
              type($target) `` `{` $target_size `}`
              attr-dict-with-keyword
</code></pre></div>

Splats a value into a subview of the given stream resource and returns the
resource with the update applied.

Traits: Stream_CmdPhaseOp

Interfaces: Stream_StreamableOp, Stream_SubviewEffectOp, Util_SizeAwareOp

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `target` | resource or external resource or transient resource or variable resource or constant resource
| `target_size` | index
| `target_offset` | index
| `target_length` | index
| `value` | 8-bit signless integer or 16-bit signless integer or 32-bit signless integer

#### `stream.cmd.flush` (Stream::CmdFlushOp)

_Flushes a subview of a resource_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.cmd.flush` (`to` `(` $source_affinity^ `)`)?
              $target `[` $target_offset `for` $target_length `]` `:`
              type($target) `` `{` $target_size `}`
              attr-dict-with-keyword
</code></pre></div>

Transfers a resource to an external target. The resource memory is made
available to the target and can be made visible there using
`stream.cmd.invalidate`.

Traits: Stream_CmdPhaseOp

Interfaces: Stream_StreamableOp, Stream_SubviewEffectOp, Util_SizeAwareOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>source_affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `target` | any stream-compatible type
| `target_size` | index
| `target_offset` | index
| `target_length` | index

#### `stream.cmd.func` (Stream::CmdFuncOp)

_Streamable function declaration_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.cmd.func` custom&lt;SymbolVisibility&gt;($sym_visibility)
              $sym_name ``
              custom&lt;DispatchFunctionSignature&gt;($function_type,
              $arg_attrs,
              $res_attrs)
              attr-dict-with-keyword
              ($body^)?
</code></pre></div>

Declares a function that can be called as an asynchronous streaming
operation via `stream.cmd.call`. Today only external functions are
allowed.

Traits: IsolatedFromAbove, Stream_CmdPhaseOp

Interfaces: CallableOpInterface, FunctionOpInterface, Symbol

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>sym_name</code></td><td>::mlir::StringAttr</td><td>string attribute</td></tr>
<tr><td><code>function_type</code></td><td>::mlir::TypeAttr</td><td>type attribute of function type</td></tr>
<tr><td><code>sym_visibility</code></td><td>::mlir::StringAttr</td><td>string attribute</td></tr>
<tr><td><code>arg_attrs</code></td><td>::mlir::ArrayAttr</td><td>Array of dictionary attributes</td></tr>
<tr><td><code>res_attrs</code></td><td>::mlir::ArrayAttr</td><td>Array of dictionary attributes</td></tr>
<table>

#### `stream.cmd.invalidate` (Stream::CmdInvalidateOp)

_Invalidates a subview of a resource_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.cmd.invalidate` (`from` `(` $source_affinity^ `)`)?
              $target `[` $target_offset `for` $target_length `]` `:`
              type($target) `` `{` $target_size `}`
              attr-dict-with-keyword
</code></pre></div>

Transfers a resource from an external source into the current target. The
resource memory is assumed to have been made available at the source via
`stream.cmd.flush`.

Traits: Stream_CmdPhaseOp

Interfaces: Stream_StreamableOp, Stream_SubviewEffectOp, Util_SizeAwareOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>source_affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `target` | any stream-compatible type
| `target_size` | index
| `target_offset` | index
| `target_length` | index

#### `stream.cmd.serial` (Stream::CmdSerialOp)

_Executes all ops serially (in-order)_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.cmd.serial` $body
              attr-dict-with-keyword
</code></pre></div>

Represents a sequence of work scheduled serially (each op executing one
after the other).

Regions can be nested to create a DAG. For example, take the following graph:
<div class="highlight"><pre><span></span><code>                  |
        v---------+-----v
+-------|-------+   +---|----+
|    v--+--v    |   |   v    |
| +----+ +----+ |   | +----+ |
| | @a | | @b | |   | | @c | |
| +----+ +----+ |   | +----+ |
|    |     |    |   |   |    |
|    |     |    |   | +-v--+ |
|    |     |    |   | | @d | |
|    |     |    |   | +----+ |
|    +--v--+    |   |   |    |
+-------|-------+   +---|----+
        +---------v-----+
                  |
</code></pre></div>

Represented with nested regions:
<div class="highlight"><pre><span></span><code>  stream.cmd.concurrent {
    stream.cmd.concurrent {
      stream.cmd.dispatch @a
      stream.cmd.dispatch @b
    }
    stream.cmd.serial {
      stream.cmd.dispatch @c
      stream.cmd.dispatch @d
    }
  }
</code></pre></div>

Traits: HasParent<IREE::Stream::CmdExecuteOp, IREE::Stream::CmdSerialOp, IREE::Stream::CmdConcurrentOp>, RecursiveMemoryEffects, SingleBlock, SingleBlockImplicitTerminator<IREE::Stream::YieldOp>, Stream_CmdPhaseOp

Interfaces: RegionBranchOpInterface, Stream_StreamableOp


### File ops

File ops.

#### `stream.file.constant` (Stream::FileConstantOp)

_Creates a file backed by the provided constant host memory_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.file.constant` (`on` `(` $affinity^ `)`)?
              $source `[` $source_offset `for` $source_length `]` `:`
              type($source) `` `{` $source_size `}`
              `-&gt;`
              type($result)
              attr-dict-with-keyword
</code></pre></div>

Synchronously wraps a host heap buffer into a stream-accessible file handle.
Changing the source buffer after definition has undefined behavior.

Traits: AlwaysSpeculatableImplTrait

Interfaces: ConditionallySpeculatable, InferTypeOpInterface, MemoryEffectOpInterface (MemoryEffectOpInterface), NoMemoryEffect (MemoryEffectOpInterface), OpAsmOpInterface, Stream_AffinityOp, SubrangeOperandOpInterface, Util_SizeAwareOp

Effects: MemoryEffects::Effect{MemoryEffects::Allocate on ::mlir::SideEffects::DefaultResource}, MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `source` | a reference counted byte buffer
| `source_size` | index
| `source_offset` | index
| `source_length` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | a file handle used for I/O operations

#### `stream.file.read` (Stream::FileReadOp)

_Reads a segment of a file into a resource_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.file.read` (`on` `(` $affinity^ `)`)?
              (`await` `(` $await_timepoint^ `)` `=` `` `&gt;`):(`:`)?
              $source `[` $source_offset `]` `,`
              $target `[` $target_offset `]` `,`
              $length `:`
              type($source) `-&gt;`
              type($target) `` `{` $target_size `}`
              `=` `` `&gt;`
              type($result_timepoint)
              attr-dict-with-keyword
</code></pre></div>

Asynchronously reads a segment of a file into a resource.

Some implementations this can stream directly from the file into
device-local memory and should be preferred to manually staging memory
through host buffers.

Traits: Stream_CmdPhaseOp

Interfaces: AffinityOpInterface, InferTypeOpInterface, Stream_TimelineOp, Util_SizeAwareOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `source` | a file handle used for I/O operations
| `source_offset` | 64-bit signless integer
| `target` | resource or external resource or transient resource or variable resource or constant resource
| `target_size` | index
| `target_offset` | index
| `length` | index
| `await_timepoint` | a timepoint indicating execution availability

##### Results:

| Result | Description |
| :----: | ----------- |
| `result_timepoint` | a timepoint indicating execution availability

#### `stream.file.write` (Stream::FileWriteOp)

_Writes a segment of a file from a resource_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.file.write` (`on` `(` $affinity^ `)`)?
              (`await` `(` $await_timepoint^ `)` `=` `` `&gt;`):(`:`)?
              $source `[` $source_offset `]` `,`
              $target `[` $target_offset `]` `,`
              $length `:`
              type($source) `` `{` $source_size `}` `-&gt;`
              type($target)
              `=` `` `&gt;`
              type($result_timepoint)
              attr-dict-with-keyword
</code></pre></div>

Asynchronously writes a segment of a resource into a file.
The file range must be valid within the file as this operation cannot
grow the underlying file storage.

Some implementations this can stream directly from device-local memory into
the file and should be preferred to manually staging memory
through host buffers.

Traits: Stream_CmdPhaseOp

Interfaces: AffinityOpInterface, InferTypeOpInterface, Stream_TimelineOp, Util_SizeAwareOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `source` | resource or external resource or transient resource or variable resource or constant resource
| `source_size` | index
| `source_offset` | index
| `target` | a file handle used for I/O operations
| `target_offset` | 64-bit signless integer
| `length` | index
| `await_timepoint` | a timepoint indicating execution availability

##### Results:

| Result | Description |
| :----: | ----------- |
| `result_timepoint` | a timepoint indicating execution availability


### Miscellaneous ops



#### `stream.return` (Stream::ReturnOp)

_Returns results from a region_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.return` attr-dict
              $operands `:` type($operands)
</code></pre></div>

The values returned are copied by-value.

Traits: AlwaysSpeculatableImplTrait, HasParent<IREE::Stream::ExecutableExportOp>, ReturnLike, Terminator

Interfaces: ConditionallySpeculatable, NoMemoryEffect (MemoryEffectOpInterface), RegionBranchTerminatorOpInterface

Effects: MemoryEffects::Effect{}

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `operands` | any type

#### `stream.yield` (Stream::YieldOp)

_Yields stream values from an execution region_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.yield` attr-dict
              ($resource_operands^ `:`
              custom&lt;SizeAwareTypeList&gt;(type($resource_operands),
              $resource_operand_sizes))?
</code></pre></div>

The values returned represent the asynchronous value at the point in time
the SSA value is defined (or tied).

Traits: AlwaysSpeculatableImplTrait, HasParent<IREE::Stream::AsyncExecuteOp, IREE::Stream::AsyncConcurrentOp, IREE::Stream::CmdExecuteOp, IREE::Stream::CmdSerialOp, IREE::Stream::CmdConcurrentOp>, SameVariadicOperandSize, Terminator

Interfaces: ConditionallySpeculatable, NoMemoryEffect (MemoryEffectOpInterface), RegionBranchTerminatorOpInterface, Util_SizeAwareOp

Effects: MemoryEffects::Effect{}

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `resource_operands` | resource or external resource or transient resource or variable resource or constant resource or staging resource
| `resource_operand_sizes` | index


### Pseudo Ops

Pseudo ops for conversion support.

#### `stream.tensor.export` (Stream::TensorExportOp)

_Conversion placeholder for stream->other type conversion_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.tensor.export` (`on` `(` $affinity^ `)`)?
              $source `:`
              $source_encoding (`` `{` $source_encoding_dims^ `}`)?
              `in`
              type($source) `` `{` $source_size `}`
              `-&gt;`
              type($result)
              attr-dict-with-keyword
</code></pre></div>

Defines a conversion to a higher-level dialect type such as `tensor` that
is resolved during lowering into the stream dialect. This can be used to
interoperate between levels of the stack that require specifying stream
types and those that prior to lowering do not handle them.

Traits: AlwaysSpeculatableImplTrait

Interfaces: ConditionallySpeculatable, NoMemoryEffect (MemoryEffectOpInterface), Stream_AffinityOp, TiedOpInterface, Util_ShapeAwareOp, Util_SizeAwareOp

Effects: MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>source_encoding</code></td><td>::mlir::TypeAttr</td><td>any type attribute</td></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `source` | external resource
| `source_encoding_dims` | index
| `source_size` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | any type

#### `stream.tensor.import` (Stream::TensorImportOp)

_Conversion placeholder for other->stream type conversion_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.tensor.import` (`on` `(` $affinity^ `)`)?
              $source `:`
              type($source)
              `-&gt;`
              $result_encoding (`` `{` $result_encoding_dims^ `}`)?
              `in`
              type($result) `{` $result_size `}`
              attr-dict-with-keyword
</code></pre></div>

Defines a conversion from a higher-level dialect type such as `tensor` that
is resolved during lowering into the stream dialect. This can be used to
interoperate between levels of the stack that require specifying stream
types and those that prior to lowering do not handle them.

Traits: AlwaysSpeculatableImplTrait

Interfaces: ConditionallySpeculatable, NoMemoryEffect (MemoryEffectOpInterface), Stream_AffinityOp, TiedOpInterface, Util_ShapeAwareOp, Util_SizeAwareOp

Effects: MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>result_encoding</code></td><td>::mlir::TypeAttr</td><td>any type attribute</td></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `source` | any type
| `result_encoding_dims` | index
| `result_size` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | external resource


### Resource ops

Generic resource ops.

#### `stream.resource.alloc` (Stream::ResourceAllocOp)

_Allocates a persistent value with undefined contents_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.resource.alloc` (`on` `(` $affinity^ `)`)?
              (`uninitialized` $uninitialized^)?
              attr-dict `:` custom&lt;SizeAwareTypeList&gt;(type($results), $storage_sizes)
</code></pre></div>

Allocates a persistent value (one that is long-lived and possibly external
to the program) with undefined contents. Consumers of the allocated
result must assume nothing of the contents and use `discard` access.

Uninitialized allocations will have undefined contents and must only be used
when all bytes are discarded prior to any reads. Runtimes decide what
"undefined contents" means and here it only indicates that execution will be
correct even if the memory starts with non-zero values.

If multiple values are allocated from the same operation it implies that
they have matching lifetimes. When lowering to execution environments the
separate allocations may be fused into one or more slab allocations in order
to reduce overheads. How many allocations can be fused is based on the size
of the individual resources and the target constraints (how large any single
buffer may be, etc). At the stream dialect level treat a multi-result alloc
as a way to indicate similar lifetimes.

Traits: AlwaysSpeculatableImplTrait

Interfaces: AffinityOpInterface, ConditionallySpeculatable, MemoryEffectOpInterface (MemoryEffectOpInterface), Util_SizeAwareOp

Effects: MemoryEffects::Effect{MemoryEffects::Allocate on ::mlir::SideEffects::DefaultResource}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>uninitialized</code></td><td>::mlir::UnitAttr</td><td>unit attribute</td></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `storage_sizes` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `results` | any stream-compatible type

#### `stream.resource.alloca` (Stream::ResourceAllocaOp)

_Allocates a transient value with undefined contents_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.resource.alloca` `uninitialized`
              (`on` `(` $affinity^ `)`)?
              (`await` `(` $await_timepoint^ `)` `=` `` `&gt;`):(`:`)?
              attr-dict
              type($result) `{` $storage_size `}`
              `=` `` `&gt;`
              type($result_timepoint)
</code></pre></div>

Allocates a transient value (one that is short-lived and local to the
current computation) with undefined contents. Consumers of the allocated
result must assume nothing of the contents and use `discard` access.

The resource returned is not valid for use until the timepoint is reached;
execution using this resource must await on the timepoint.

Traits: AlwaysSpeculatableImplTrait

Interfaces: AffinityOpInterface, ConditionallySpeculatable, MemoryEffectOpInterface (MemoryEffectOpInterface), Stream_TimelineOp, Util_SizeAwareOp

Effects: MemoryEffects::Effect{MemoryEffects::Allocate on ::mlir::SideEffects::DefaultResource}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `storage_size` | index
| `await_timepoint` | a timepoint indicating execution availability

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | staging resource or transient resource
| `result_timepoint` | a timepoint indicating execution availability

#### `stream.resource.constants` (Stream::ResourceConstantsOp)

_Asynchronously uploads or maps constant values_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.resource.constants` (`on` `(` $affinity^ `)`)?
              attr-dict `:`
              custom&lt;ConstantValueList&gt;(type($results),
              $result_sizes,
              $values)
              `\n` ` ` ` ` `=` `` `&gt;` type($result_timepoint)
</code></pre></div>

Represents an upload of constant resources that may be packed, suballocated,
and mapped depending on the final lowering target.

In runtime environments where memory is shared between host and device this
turns into a mapping operation that avoids additional memory allocation and
copies. When memory cannot be shared an asynchronous stream will be created
to allocate and copy all of the constant values.

Though this op returns a unique resource for each constant value it's
expected that almost all end up aliasing into the same storage. The exact
packing and number of storage resources that are needed are not known until
lowering to a particular backend, though, so they are separate here for
proper usage tracking.

Both constant and variable resources can be produced; a constant is
immutable while a variable will be treated as a constant-value initializer
for a mutable resource. By modeling these together it's not required that
variable initializers first be allocated, copied to the target, and then
copied into the variable storage if the target is capable of doing a direct
upload or mapping.

Traits: AlwaysSpeculatableImplTrait, SameVariadicResultSize

Interfaces: ConditionallySpeculatable, NoMemoryEffect (MemoryEffectOpInterface), Stream_AffinityOp, Stream_TimelineOp, Util_SizeAwareOp

Effects: MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>values</code></td><td>::mlir::ArrayAttr</td><td>constant value array attribute</td></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `result_sizes` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `results` | constant resource or variable resource
| `result_timepoint` | a timepoint indicating execution availability

#### `stream.resource.dealloca` (Stream::ResourceDeallocaOp)

_Frees a transient value when available_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.resource.dealloca` (`on` `(` $affinity^ `)`)?
              (`await` `(` $await_timepoint^ `)` `=` `` `&gt;`)?
              $operand `:` type($operand) `{` $operand_size `}`
              `=` `` `&gt;` type($result_timepoint)
              attr-dict
</code></pre></div>

Deallocates a transient value (one that is short-lived and local to the
current computation) previously allocated using `stream.resource.alloca`.

The resource is considered live and valid until the provided timepoint is
reached and the memory is only made available for future requests after
the result timepoint is reached.

Interfaces: AffinityOpInterface, InferTypeOpInterface, MemoryEffectOpInterface (MemoryEffectOpInterface), Stream_TimelineOp, Util_SizeAwareOp

Effects: MemoryEffects::Effect{MemoryEffects::Free on ::mlir::SideEffects::DefaultResource}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `operand` | staging resource or transient resource
| `operand_size` | index
| `await_timepoint` | a timepoint indicating execution availability

##### Results:

| Result | Description |
| :----: | ----------- |
| `result_timepoint` | a timepoint indicating execution availability

#### `stream.resource.load` (Stream::ResourceLoadOp)

_Loads a value from a staging resource_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.resource.load` $source `[` $source_offset `]` `:`
              type($source) `` `{` $source_size `}`
              `-&gt;`
              type($result)
              attr-dict-with-keyword
</code></pre></div>

Returns the element(s) at the given offset in the staging resource.
The operation will complete synchronously against the resource though it may
introduce a yield point if the staging resource needs to be transferred.

Interfaces: Util_SizeAwareOp

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `source` | staging resource
| `source_size` | index
| `source_offset` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | index or integer or floating-point or complex-type or vector of any type values

#### `stream.resource.pack` (Stream::ResourcePackOp)

_Packs variable-sized slices into a single slab_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.resource.pack` (`on` `(` $affinity^ `)`)?
              (`offset` `(` $offset^ `)`)?
              `slices` `(` `{`
              custom&lt;PackSliceRanges&gt;($lifetime_intervals,
              $dynamic_slice_sizes,
              type($packed_offsets))
              `}` `)`
              `:` type($total_length)
              attr-dict-with-keyword
</code></pre></div>

Performs a greedy packing of one or more sized slices with specified
lifetimes and returns their relative offsets in an aliased linear space.

Slices are `[start, end] = %slice_byte_size`, where the start and end values
define an inclusive lifetime range and the size is the total number of bytes
required to be live for that range.

<div class="highlight"><pre><span></span><code>// Computes the total length required for the packed values and the offsets
// of the 3 slices requested relative to the base of the packed memory:
%total_length, %offset_0, %offset_1, %offset_2 =
    stream.resource.pack
        // Each slice gets one result offset:
        slices({
          // 3 slices where A and B overlap and will get unique offsets
          // while B and C do not overlap and are allowed to alias.
          [0, 10] = %size_0,  // A =&gt; %offset_0
          [3,  8] = %size_1,  // B =&gt; %offset_1
          [9, 10] = %size_2,  // C =&gt; %offset_2
          ...
        }) : index
</code></pre></div>

The lifetime start and end points (inclusive) are only used for relative
comparisons and may originate with any meaning (op order in block, epoch,
phase of the moon, etc). The packing algorithm uses the intervals to
determine slice liveness and when aliasing is safe.

The size of each slice may either be a constant or runtime-computed dynamic
value. Constant slices can achieve more dense packing than the dynamic
values and CSE/canonicalization should be applied to ensure that as many of
the dynamic values are equivalent if possible.

The total length required to pack all slices is returned and can be used to
acquire storage. The individual slice offsets are 0-based and as such if are
directly used as buffer offsets may need additional offsetting. This can
either be applied via the optional `offset` operand or slicing of the
underlying allocation buffer.

Traits: AlwaysSpeculatableImplTrait, AttrSizedOperandSegments

Interfaces: ConditionallySpeculatable, NoMemoryEffect (MemoryEffectOpInterface), OpAsmOpInterface, Stream_AffinityOp

Effects: MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>lifetime_intervals</code></td><td>::mlir::ArrayAttr</td><td>index array attribute</td></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `offset` | index
| `dynamic_slice_sizes` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `total_length` | index
| `packed_offsets` | index

#### `stream.resource.size` (Stream::ResourceSizeOp)

_Returns the size of the resource storage in bytes_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.resource.size` (`on` `(` $affinity^ `)`)?
              $operand
              attr-dict `:` type($operand)
</code></pre></div>

Returns a possibly runtime-dynamic byte size of the resource backing
storage. This may differ from the logical storage size of a value based on
the alignment requirements of the target as well as encoding of higher level
values such as sparse tensor formats.

Traits: AlwaysSpeculatableImplTrait

Interfaces: ConditionallySpeculatable, InferTypeOpInterface, NoMemoryEffect (MemoryEffectOpInterface), Stream_AffinityOp, Util_SizeAwareOp

Effects: MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `operand` | any stream-compatible type

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | index

#### `stream.resource.store` (Stream::ResourceStoreOp)

_Stores a value into a staging resource_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.resource.store` $value `,`
              $target `[` $target_offset `]` `:`
              type($value)
              `-&gt;`
              type($target) `{` $target_size `}`
              attr-dict-with-keyword
</code></pre></div>

The operation will complete synchronously against the resource though it may
introduce a yield point if the staging resource needs to be acquired.

Interfaces: MemoryEffectOpInterface (MemoryEffectOpInterface), Util_SizeAwareOp

Effects: MemoryEffects::Effect{MemoryEffects::Write on ::mlir::SideEffects::DefaultResource}

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `target` | staging resource
| `target_size` | index
| `target_offset` | index
| `value` | index or integer or floating-point or complex-type or vector of any type values

#### `stream.resource.subview` (Stream::ResourceSubviewOp)

_Slices out a cloned subview of a value_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.resource.subview` $source `[` $source_offset `]` `:`
              type($source) `` `{` $source_size `}` `-&gt;`
              type($result) `` `{` $result_size `}`
              attr-dict-with-keyword
</code></pre></div>

Aliases a byte subrange of a resource.

Traits: AlwaysSpeculatableImplTrait

Interfaces: ConditionallySpeculatable, InferTypeOpInterface, NoMemoryEffect (MemoryEffectOpInterface), StreamableOpInterface, TiedOpInterface, Util_SizeAwareOp, Util_SubrangeOp, ViewLikeOpInterface

Effects: MemoryEffects::Effect{}

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `source` | any stream-compatible type
| `source_size` | index
| `source_offset` | index
| `result_size` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | any stream-compatible type

#### `stream.resource.try_map` (Stream::ResourceTryMapOp)

_Maps read-only memory into a resource_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.resource.try_map` (`on` `(` $affinity^ `)`)?
              $source `[` $source_offset `]` `:`
              type($source)
              `-&gt;`
              type($did_map) `,` type($result) `` `{` $result_size `}`
              attr-dict-with-keyword
</code></pre></div>

Synchronously maps a host heap buffer into a stream-accessible resource
with the requested lifetime. If the given source cannot be mapped the
`did_map` result will be 0 and users must find another route into memory
(such as file I/O). The resulting resource is not coherent with the source
and behavior is undefined if the underlying contents change.

Traits: AlwaysSpeculatableImplTrait

Interfaces: ConditionallySpeculatable, MemoryEffectOpInterface (MemoryEffectOpInterface), NoMemoryEffect (MemoryEffectOpInterface), Stream_AffinityOp, Util_SizeAwareOp

Effects: MemoryEffects::Effect{MemoryEffects::Allocate on ::mlir::SideEffects::DefaultResource}, MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `source` | a reference counted byte buffer
| `source_offset` | index
| `result_size` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `did_map` | 1-bit signless integer
| `result` | resource or external resource or transient resource or variable resource or constant resource


### Resource transfer ops



#### `stream.async.alloca` (Stream::AsyncAllocaOp)

_Allocates a transient value with undefined contents_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.async.alloca` (`on` `(` $affinity^ `)`)?
              attr-dict `:` type($result) `{` $storage_size `}`
</code></pre></div>

Allocates a transient value (one that is short-lived and local to the
current computation) with undefined contents. Consumers of the allocated
result must assume nothing of the contents and use `discard` access.

Traits: AlwaysSpeculatableImplTrait, Stream_AsyncPhaseOp

Interfaces: AffinityOpInterface, ConditionallySpeculatable, MemoryEffectOpInterface (MemoryEffectOpInterface), StreamableOpInterface, Util_SizeAwareOp

Effects: MemoryEffects::Effect{MemoryEffects::Allocate on ::mlir::SideEffects::DefaultResource}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `storage_size` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | resource or external resource or transient resource or variable resource or constant resource

#### `stream.async.clone` (Stream::AsyncCloneOp)

_Clones the contents of a value_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.async.clone` (`on` `(` $affinity^ `)`)?
              $source `:`
              type($source) `` `{` $source_size `}` `-&gt;`
              type($result) `` `{` $result_size `}`
              attr-dict-with-keyword
</code></pre></div>

Clones the contents of a value at a snapshot in time. Future changes to the
cloned value will not effect the result. Acts as a copy-on-write operation.

Traits: Stream_AsyncPhaseOp

Interfaces: AsyncAccessOpInterface, Stream_AffinityOp, StreamableOpInterface, Util_SizeAwareOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `source` | resource or external resource or transient resource or variable resource or constant resource
| `source_size` | index
| `result_size` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | resource or external resource or transient resource or variable resource or constant resource

#### `stream.async.collective` (Stream::AsyncCollectiveOp)

_Performs a collective operation_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.async.collective` `` $op `` `[` $element_count `]`
              (`on` `(` $affinity^ `)`)?
              `channel` `(` $channel `)`
              custom&lt;CollectiveParam&gt;(ref($op), $param) ``
              $source `[` $source_offset `to` $source_end `for` $source_length `]` `,`
              $target `[` $target_offset `to` $target_end `for` $target_length `]` `:`
              type($source) `` `{` $source_size `}` `-&gt;`
              custom&lt;ShapedTiedResult&gt;(type($target), $target_size)
              attr-dict-with-keyword
</code></pre></div>

TODO: document different usage. For now this should be considered a
prototype and that modeling of collective operations may change in the
future to better ensure in-place operations (where send/recv is a subset of
recv/send). We may have dedicated operations for the send and recv verbs as
they have sequencing implications - or we could add optional sequencing to
this base op.

Traits: Stream_AsyncPhaseOp

Interfaces: AsyncAccessOpInterface, InferTypeOpInterface, Stream_AffinityOp, Stream_StreamableOp, TiedOpInterface, Util_SizeAwareOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>op</code></td><td>::mlir::iree_compiler::IREE::Stream::CollectiveAttr</td><td><details><summary>collective operation and specification</summary>{{% markdown %}}
    Specifies the collective operation to perform and any mode bits required.
  {{% /markdown %}}</details></td></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `target` | resource or external resource or transient resource or variable resource or constant resource
| `target_size` | index
| `target_offset` | index
| `target_end` | index
| `target_length` | index
| `source` | resource or external resource or transient resource or variable resource or constant resource
| `source_size` | index
| `source_offset` | index
| `source_end` | index
| `source_length` | index
| `element_count` | index
| `channel` | a collective communication channel
| `param` | 32-bit signless integer

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | resource or external resource or transient resource or variable resource or constant resource

#### `stream.async.constant` (Stream::AsyncConstantOp)

_Defines a constant resource_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.async.constant` (`on` `(` $affinity^ `)`)?
              `:`
              type($result) `` `{` $result_size `}`
              `=`
              $value
              attr-dict-with-keyword
</code></pre></div>

Returns a new resource with the given constant value.

Traits: AlwaysSpeculatableImplTrait, Stream_AsyncPhaseOp

Interfaces: AsyncAccessOpInterface, ConditionallySpeculatable, NoMemoryEffect (MemoryEffectOpInterface), OpAsmOpInterface, Stream_AffinityOp, StreamableOpInterface, Util_SizeAwareOp

Effects: MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>value</code></td><td>::mlir::Attribute</td><td>any attribute</td></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `result_size` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | resource or external resource or transient resource or variable resource or constant resource

#### `stream.async.copy` (Stream::AsyncCopyOp)

_Copies a subview of a stream resource to another_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.async.copy` (`on` `(` $affinity^ `)`)?
              $source `[` $source_offset `to` $source_end `]` `,`
              $target `[` $target_offset `to` $target_end `]` `,`
              $length `:`
              type($source) `` `{` $source_size `}` `-&gt;`
              custom&lt;ShapedTiedResult&gt;(type($target), $target_size)
              attr-dict-with-keyword
</code></pre></div>

Copies a subview of a resource into a subview of another.
As with memcpy this does not support overlapping updates into the same
resource. Unlike `stream.async.update` copy sources cannot be allocated
in-place.

Equivalent to a stream.async.slice + stream.async.update.

Traits: Stream_AsyncPhaseOp

Interfaces: AsyncAccessOpInterface, InferTypeOpInterface, Stream_AffinityOp, Stream_StreamableOp, TiedOpInterface, Util_SizeAwareOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `target` | resource or external resource or transient resource or variable resource or constant resource
| `target_size` | index
| `target_offset` | index
| `target_end` | index
| `source` | resource or external resource or transient resource or variable resource or constant resource
| `source_size` | index
| `source_offset` | index
| `source_end` | index
| `length` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | resource or external resource or transient resource or variable resource or constant resource

#### `stream.async.dispatch` (Stream::AsyncDispatchOp)

_Dispatches a parallelized grid of work_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.async.dispatch` (`on` `(` $affinity^ `)`)?
              $entry_point
              (`[` $workload^ `]`)? ``
              custom&lt;DispatchOperands&gt;($resource_operands,
              $resource_operand_offsets,
              $resource_operand_ends,
              $resource_operand_lengths) attr-dict `:`
              custom&lt;ShapedFunctionType&gt;(ref($resource_operands),
              type($resource_operands), $resource_operand_sizes,
              type($results), $result_sizes,
              $tied_operands)
</code></pre></div>

Calls the specified entry point function once for each element in the
specified workgroup count. Each workgroup has access to the same operands
and results and is able to load/store at will.

Traits: AttrSizedOperandSegments, Stream_AsyncPhaseOp

Interfaces: AsyncAccessOpInterface, Stream_AffinityOp, Stream_StreamableOp, SymbolUserOpInterface, TiedOpInterface, Util_SizeAwareOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>entry_point</code></td><td>::mlir::SymbolRefAttr</td><td>symbol reference attribute</td></tr>
<tr><td><code>tied_operands</code></td><td>::mlir::ArrayAttr</td><td>64-bit integer array attribute</td></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `workload` | index
| `resource_operands` | resource or external resource or transient resource or variable resource or constant resource or index or integer or floating-point or complex-type
| `resource_operand_sizes` | index
| `resource_operand_offsets` | index
| `resource_operand_ends` | index
| `resource_operand_lengths` | index
| `result_sizes` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `results` | resource or external resource or transient resource or variable resource or constant resource

#### `stream.async.fill` (Stream::AsyncFillOp)

_Fills a subview of a stream resource with a value_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.async.fill` (`on` `(` $affinity^ `)`)?
              $value `,`
              $target `[` $target_offset `to` $target_end `for` $target_length `]` `:`
              type($value) `-&gt;`
              custom&lt;ShapedTiedResult&gt;(type($target), $target_size)
              attr-dict-with-keyword
</code></pre></div>

Splats a value into a subview of the given stream resource and returns the
resource with the update applied.

Equivalent to a stream.async.splat + stream.async.update.

Traits: Stream_AsyncPhaseOp

Interfaces: AsyncAccessOpInterface, InferTypeOpInterface, Stream_AffinityOp, Stream_StreamableOp, TiedOpInterface, Util_SizeAwareOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `target` | resource or external resource or transient resource or variable resource or constant resource
| `target_size` | index
| `target_offset` | index
| `target_end` | index
| `target_length` | index
| `value` | 8-bit signless integer or 16-bit signless integer or 32-bit signless integer or 64-bit signless integer

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | resource or external resource or transient resource or variable resource or constant resource

#### `stream.async.load` (Stream::AsyncLoadOp)

_Loads a value from a resource_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.async.load` $source `[` $source_offset `]` `:`
              type($source) `` `{` $source_size `}`
              `-&gt;`
              type($result)
              attr-dict-with-keyword
</code></pre></div>

Returns the element at the given location from within the resource.

Traits: AlwaysSpeculatableImplTrait, Stream_AsyncPhaseOp

Interfaces: ConditionallySpeculatable, NoMemoryEffect (MemoryEffectOpInterface), Util_SizeAwareOp

Effects: MemoryEffects::Effect{}

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `source` | staging resource
| `source_size` | index
| `source_offset` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | index or integer or floating-point or complex-type or vector of any type values

#### `stream.async.slice` (Stream::AsyncSliceOp)

_Slices out a cloned subview of a value_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.async.slice` (`on` `(` $affinity^ `)`)?
              $source `[` $source_offset `to` $source_end `]` `:`
              type($source) `` `{` $source_size `}` `-&gt;`
              type($result) `` `{` $result_size `}`
              attr-dict-with-keyword
</code></pre></div>

Slices a subrange of a stream resource based on a byte range. Acts as a
copy-on-write operation.

Traits: AlwaysSpeculatableImplTrait, Stream_AsyncPhaseOp

Interfaces: AsyncAccessOpInterface, ConditionallySpeculatable, InferTypeOpInterface, NoMemoryEffect (MemoryEffectOpInterface), Stream_AffinityOp, Stream_StreamableOp, Util_SizeAwareOp

Effects: MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `source` | resource or external resource or transient resource or variable resource or constant resource
| `source_size` | index
| `source_offset` | index
| `source_end` | index
| `result_size` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | resource or external resource or transient resource or variable resource or constant resource

#### `stream.async.splat` (Stream::AsyncSplatOp)

_Splats a value into a resource_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.async.splat` (`on` `(` $affinity^ `)`)?
              $value `:` type($value) `-&gt;` type($result) `` `{` $result_size `}`
              attr-dict-with-keyword
</code></pre></div>

Returns a new resource with the given primitive value splatted out to fill
the entire contents.

Traits: Stream_AsyncPhaseOp

Interfaces: AsyncAccessOpInterface, Stream_AffinityOp, StreamableOpInterface, Util_SizeAwareOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `value` | 8-bit signless integer or 16-bit signless integer or 32-bit signless integer or 64-bit signless integer
| `result_size` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | resource or external resource or transient resource or variable resource or constant resource

#### `stream.async.store` (Stream::AsyncStoreOp)

_Stores a value into a resource_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.async.store` $value `,`
              $target `[` $target_offset `]` `:`
              type($value)
              `-&gt;`
              custom&lt;ShapedTiedResult&gt;(type($target), $target_size)
              attr-dict-with-keyword
</code></pre></div>

Returns a resource with the element at the given offset set to the given
value.

Traits: AlwaysSpeculatableImplTrait, Stream_AsyncPhaseOp

Interfaces: ConditionallySpeculatable, InferTypeOpInterface, NoMemoryEffect (MemoryEffectOpInterface), TiedOpInterface, Util_SizeAwareOp

Effects: MemoryEffects::Effect{}

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `target` | staging resource
| `target_size` | index
| `target_offset` | index
| `value` | index or integer or floating-point or complex-type or vector of any type values

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | staging resource

#### `stream.async.transfer` (Stream::AsyncTransferOp)

_Transfers a resource from one location/state to another_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.async.transfer` (`from` `(` $source_affinity^ `)`)?
              $source `:`
              type($source) `` `{` $source_size `}` `-&gt;`
              (`to` `(` $result_affinity^ `)`)?
              type($result) `` `{` $result_size `}`
              attr-dict-with-keyword
</code></pre></div>

Transfers a resource between different states (such as a `staging` lifetime
to a `local` lifetime) or different affinities. This is roughly equivalent
to a cast but may have special semantics when later lowered to one or more
devices with discrete memory spaces or pools.

Traits: Stream_AsyncPhaseOp

Interfaces: AsyncAccessOpInterface, Stream_AffinityOp, Stream_StreamableOp, Util_SizeAwareOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>source_affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<tr><td><code>result_affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `source` | resource or external resource or transient resource or variable resource or constant resource or staging resource
| `source_size` | index
| `result_size` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | resource or external resource or transient resource or variable resource or constant resource or staging resource

#### `stream.async.update` (Stream::AsyncUpdateOp)

_Updates a slice of a subview of a resource in-place_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.async.update` (`on` `(` $affinity^ `)`)?
              $update `,`
              $target `[` $target_offset `to` $target_end `]` `:`
              type($update) `` `{` $update_size `}` `-&gt;`
              custom&lt;ShapedTiedResult&gt;(type($target), $target_size)
              attr-dict-with-keyword
</code></pre></div>

Copies a value into a resource based on a byte range. The returned value
is the entire updated target value. Updates can be turned into placement
allocations and avoid copies.

Traits: Stream_AsyncPhaseOp

Interfaces: AsyncAccessOpInterface, InferTypeOpInterface, Stream_AffinityOp, Stream_StreamableOp, TiedOpInterface, Util_SizeAwareOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `target` | resource or external resource or transient resource or variable resource or constant resource
| `target_size` | index
| `target_offset` | index
| `target_end` | index
| `update` | resource or external resource or transient resource or variable resource or constant resource
| `update_size` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | resource or external resource or transient resource or variable resource or constant resource


### Synchronization ops



#### `stream.timepoint.await` (Stream::TimepointAwaitOp)

_Awaits a timepoint before returning a set of resources_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.timepoint.await` (`on` `(` $affinity^ `)`)?
              $await_timepoint `=` `` `&gt;`
              $resource_operands `:`
              custom&lt;SizeAwareTypeList&gt;(type($resource_operands),
              type($results), $resource_operand_sizes)
              attr-dict-with-keyword
</code></pre></div>

After asynchronous execution scheduling resources may exist in different
states at different points in the execution timeline. This op enables
resolving the version of a resource after a particular point in the
timeline. As timepoints transitively chain the timepoint must only cover the
resource availability but not be limited to its original production
timepoint.

Traits: AlwaysSpeculatableImplTrait, AttrSizedOperandSegments

Interfaces: ConditionallySpeculatable, NoMemoryEffect (MemoryEffectOpInterface), Stream_AffinityOp, Stream_TimelineOp, TiedOpInterface, Util_SizeAwareOp

Effects: MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `resource_operands` | resource or external resource or transient resource or variable resource or constant resource or staging resource
| `resource_operand_sizes` | index
| `await_timepoint` | a timepoint indicating execution availability

##### Results:

| Result | Description |
| :----: | ----------- |
| `results` | resource or external resource or transient resource or variable resource or constant resource or staging resource

#### `stream.timepoint.barrier` (Stream::TimepointBarrierOp)

_Returns a timepoint indicating when a resource is available_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.timepoint.barrier` (`on` `(` $affinity^ `)`)?
              $resource `:` type($resource) `` `{` $resource_size `}`
              `=` `` `&gt;`
              type($result_timepoint)
              attr-dict-with-keyword
</code></pre></div>

After asynchronous execution scheduling resources may exist in different
states at different points in the execution timeline. This op enables
identifying when the version of a resource after a particular point in the
timeline is available. As timepoints transitively chain the timepoint must
only cover the resource availability but not be limited to its original
production timepoint.

Traits: AlwaysSpeculatableImplTrait

Interfaces: ConditionallySpeculatable, InferTypeOpInterface, NoMemoryEffect (MemoryEffectOpInterface), Stream_AffinityOp, Stream_TimelineOp, TiedOpInterface, Util_SizeAwareOp

Effects: MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `resource` | resource or external resource or transient resource or variable resource or constant resource or staging resource
| `resource_size` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | resource or external resource or transient resource or variable resource or constant resource or staging resource
| `result_timepoint` | a timepoint indicating execution availability

#### `stream.timepoint.chain_external` (Stream::TimepointChainExternalOp)

_Exports a timepoint to an external dialect type_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.timepoint.chain_external` (`on` `(` $affinity^ `)`)?
              $await_timepoint
              `=` `` `&gt;`
              `(` $external_values `:` type($external_values) `)`
              attr-dict-with-keyword
</code></pre></div>

Defines a conversion to an external dialect type such as `hal.fence`
that is resolved during lowering into the stream dialect. This can be used
to interoperate between levels of the stack that require specifying stream
types and those that prior to lowering do not handle them.

Interfaces: Stream_AffinityOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `await_timepoint` | a timepoint indicating execution availability
| `external_values` | any type

#### `stream.timepoint.export` (Stream::TimepointExportOp)

_Exports a timepoint to an external dialect type_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.timepoint.export` (`on` `(` $affinity^ `)`)?
              $await_timepoint
              `=` `` `&gt;`
              `(` type($results) `)`
              attr-dict-with-keyword
</code></pre></div>

Defines a conversion to an external dialect type such as `hal.fence`
that is resolved during lowering into the stream dialect. This can be used
to interoperate between levels of the stack that require specifying stream
types and those that prior to lowering do not handle them.

Traits: AlwaysSpeculatableImplTrait

Interfaces: ConditionallySpeculatable, NoMemoryEffect (MemoryEffectOpInterface), Stream_AffinityOp

Effects: MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `await_timepoint` | a timepoint indicating execution availability

##### Results:

| Result | Description |
| :----: | ----------- |
| `results` | any type

#### `stream.timepoint.immediate` (Stream::TimepointImmediateOp)

_Results an immediately-available timepoint_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.timepoint.immediate` attr-dict
              `=` `` `&gt;` type($result_timepoint)
</code></pre></div>

Timepoints indicate a point in the execution timeline and this op can be
used to get a placeholder representing the start of the timeline. Any waits
on the returned timepoint will resolve immediately. This generally folds
away but can be useful if needing to initialize globals or branch args.

Traits: AlwaysSpeculatableImplTrait, ConstantLike

Interfaces: ConditionallySpeculatable, InferTypeOpInterface, NoMemoryEffect (MemoryEffectOpInterface), Stream_TimelineOp

Effects: MemoryEffects::Effect{}

##### Results:

| Result | Description |
| :----: | ----------- |
| `result_timepoint` | a timepoint indicating execution availability

#### `stream.timepoint.import` (Stream::TimepointImportOp)

_Imports a timepoint from an external dialect type_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.timepoint.import` (`on` `(` $affinity^ `)`)?
              $operands `:` `(` type($operands) `)`
              `=` `` `&gt;`
              type($result_timepoint)
              attr-dict-with-keyword
</code></pre></div>

Defines a conversion from an external dialect type such as `hal.semaphore`
that is resolved during lowering into the stream dialect. This can be used
to interoperate between levels of the stack that require specifying stream
types and those that prior to lowering do not handle them.

Traits: AlwaysSpeculatableImplTrait

Interfaces: ConditionallySpeculatable, InferTypeOpInterface, NoMemoryEffect (MemoryEffectOpInterface), Stream_AffinityOp

Effects: MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `operands` | any type

##### Results:

| Result | Description |
| :----: | ----------- |
| `result_timepoint` | a timepoint indicating execution availability

#### `stream.timepoint.join` (Stream::TimepointJoinOp)

_Joins one or more timepoints into the max of all of them_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.timepoint.join` `max` `(` $await_timepoints `)` `=` `` `&gt;` type($result_timepoint)
              attr-dict-with-keyword
</code></pre></div>

Returns a timepoint that indicates that all of the input timepoints have
been reached.

Traits: AlwaysSpeculatableImplTrait

Interfaces: ConditionallySpeculatable, InferTypeOpInterface, NoMemoryEffect (MemoryEffectOpInterface), Stream_TimelineOp

Effects: MemoryEffects::Effect{}

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `await_timepoints` | a timepoint indicating execution availability

##### Results:

| Result | Description |
| :----: | ----------- |
| `result_timepoint` | a timepoint indicating execution availability


### Tensor ops



#### `stream.tensor.clone` (Stream::TensorCloneOp)

_Clones the contents of a value_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.tensor.clone` (`on` `(` $affinity^ `)`)?
              $source `:`
              $source_encoding (`` `{` $source_encoding_dims^ `}`)?
              `in`
              type($source) `` `{` $source_size `}`
              `-&gt;`
              $result_encoding (`` `{` $result_encoding_dims^ `}`)?
              `in`
              type($result) `` `{` $result_size `}`
              attr-dict-with-keyword
</code></pre></div>

Clones the contents of a value at a snapshot in time. Future changes to the
cloned value will not effect the result. Acts as a copy-on-write operation.

Traits: AlwaysSpeculatableImplTrait, AttrSizedOperandSegments, Stream_TensorPhaseOp

Interfaces: ConditionallySpeculatable, NoMemoryEffect (MemoryEffectOpInterface), Stream_AffinityOp, Stream_StreamableOp, Util_ShapeAwareOp, Util_SizeAwareOp

Effects: MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>source_encoding</code></td><td>::mlir::TypeAttr</td><td>any type attribute</td></tr>
<tr><td><code>result_encoding</code></td><td>::mlir::TypeAttr</td><td>any type attribute</td></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `source` | resource or external resource or transient resource or variable resource or constant resource
| `source_encoding_dims` | index
| `source_size` | index
| `result_encoding_dims` | index
| `result_size` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | resource or external resource or transient resource or variable resource or constant resource

#### `stream.tensor.constant` (Stream::TensorConstantOp)

_Defines a constant tensor value_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.tensor.constant` (`on` `(` $affinity^ `)`)?
              `:`
              $result_encoding (`` `{` $result_encoding_dims^ `}`)?
              `in`
              type($result)
              `=`
              $value
              attr-dict-with-keyword
</code></pre></div>

Returns a typed resource initialized to the given constant value.

Traits: AlwaysSpeculatableImplTrait, Stream_TensorPhaseOp

Interfaces: ConditionallySpeculatable, NoMemoryEffect (MemoryEffectOpInterface), OpAsmOpInterface, Stream_AffinityOp, Stream_StreamableOp, Util_ShapeAwareOp

Effects: MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>value</code></td><td>::mlir::Attribute</td><td>any attribute</td></tr>
<tr><td><code>result_encoding</code></td><td>::mlir::TypeAttr</td><td>any type attribute</td></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `result_encoding_dims` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | resource or external resource or transient resource or variable resource or constant resource

#### `stream.tensor.empty` (Stream::TensorEmptyOp)

_Defines an empty tensor value_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.tensor.empty` (`on` `(` $affinity^ `)`)?
              `:`
              $result_encoding (`` `{` $result_encoding_dims^ `}`)?
              `in`
              type($result) `` `{` $result_size `}`
              attr-dict-with-keyword
</code></pre></div>

Returns a typed resource initialized with no contents. This still carries
shape metadata and may encode to a non-empty resource such as in cases
where the empty representation still has data (e.g. sparse tensors).
Subsequent writes must populate any ranges of the tensor that are later
read.

Traits: AlwaysSpeculatableImplTrait, Stream_TensorPhaseOp

Interfaces: ConditionallySpeculatable, NoMemoryEffect (MemoryEffectOpInterface), OpAsmOpInterface, Stream_AffinityOp, StreamableOpInterface, Util_ShapeAwareOp, Util_SizeAwareOp

Effects: MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>result_encoding</code></td><td>::mlir::TypeAttr</td><td>any type attribute</td></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `result_encoding_dims` | index
| `result_size` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | resource or external resource or transient resource or variable resource or constant resource

#### `stream.tensor.fill` (Stream::TensorFillOp)

_Fills a subview of a stream resource with a value_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.tensor.fill` (`on` `(` $affinity^ `)`)?
              $value `,` $target `[` $start_indices `for` $lengths `]` `:`
              type($value)
              `-&gt;`
              $target_encoding (`` `{` $target_encoding_dims^ `}`)?
              `in`
              custom&lt;ShapedTiedResult&gt;(type($target), $target_size)
              attr-dict-with-keyword
</code></pre></div>

Splats a value into a subview of the given stream resource and returns the
resource with the update applied.

Equivalent to a stream.tensor.splat + stream.tensor.update.

Traits: AttrSizedOperandSegments, Stream_TensorPhaseOp

Interfaces: InferTypeOpInterface, Stream_AffinityOp, Stream_StreamableOp, TiedOpInterface, Util_ShapeAwareOp, Util_SizeAwareOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>target_encoding</code></td><td>::mlir::TypeAttr</td><td>any type attribute</td></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `target` | resource or external resource or transient resource or variable resource or constant resource
| `target_encoding_dims` | index
| `target_size` | index
| `start_indices` | index
| `lengths` | index
| `value` | index or integer or floating-point or complex-type

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | resource or external resource or transient resource or variable resource or constant resource

#### `stream.tensor.load` (Stream::TensorLoadOp)

_Loads a value from a tensor element_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.tensor.load` $source (`[` $indices^ `]`)? `:`
              $source_encoding (`` `{` $source_encoding_dims^ `}`)?
              `in`
              type($source) `` `{` $source_size `}`
              `-&gt;`
              type($result)
              attr-dict-with-keyword
</code></pre></div>

Returns the element at the given location from within the tensor.

Traits: AlwaysSpeculatableImplTrait, AttrSizedOperandSegments, Stream_TensorPhaseOp

Interfaces: ConditionallySpeculatable, NoMemoryEffect (MemoryEffectOpInterface), Util_ShapeAwareOp, Util_SizeAwareOp

Effects: MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>source_encoding</code></td><td>::mlir::TypeAttr</td><td>any type attribute</td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `source` | staging resource
| `source_encoding_dims` | index
| `source_size` | index
| `indices` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | index or integer or floating-point or complex-type or vector of any type values

#### `stream.tensor.sizeof` (Stream::TensorSizeOfOp)

_Calculates the storage size of a given high-level type_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.tensor.sizeof` (`on` `(` $affinity^ `)`)?
              $encoding (`{` $encoding_dims^ `}`)?
              attr-dict `:` type($storage_size)
</code></pre></div>

Target-dependent storage size calculation using a high-level annotated type.
While within the stream dialect the storage size of a value is left as a
placeholder using this op. The requisite target-specific parameters for
expanding the size calculation are only available after affinities have been
assigned.

Traits: AlwaysSpeculatableImplTrait, Stream_TensorPhaseOp

Interfaces: ConditionallySpeculatable, InferTypeOpInterface, NoMemoryEffect (MemoryEffectOpInterface), Stream_AffinityOp

Effects: MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>encoding</code></td><td>::mlir::TypeAttr</td><td>any type attribute</td></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `encoding_dims` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `storage_size` | index

#### `stream.tensor.slice` (Stream::TensorSliceOp)

_Slices out a cloned subview of a value_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.tensor.slice` (`on` `(` $affinity^ `)`)?
              $source `[` $start_indices `for` $lengths `]` `:`
              $source_encoding (`` `{` $source_encoding_dims^ `}`)?
              `in`
              type($source) `` `{` $source_size `}`
              `-&gt;`
              $result_encoding (`` `{` $result_encoding_dims^ `}`)?
              `in`
              type($result) `` `{` $result_size `}`
              attr-dict-with-keyword
</code></pre></div>

Slices a subrange of a stream resource based on a tensor encoding. Acts as a
copy-on-write operation.

Traits: AlwaysSpeculatableImplTrait, AttrSizedOperandSegments, Stream_TensorPhaseOp

Interfaces: ConditionallySpeculatable, NoMemoryEffect (MemoryEffectOpInterface), Stream_AffinityOp, Stream_StreamableOp, Util_ShapeAwareOp, Util_SizeAwareOp

Effects: MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>source_encoding</code></td><td>::mlir::TypeAttr</td><td>any type attribute</td></tr>
<tr><td><code>result_encoding</code></td><td>::mlir::TypeAttr</td><td>any type attribute</td></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `source` | resource or external resource or transient resource or variable resource or constant resource
| `source_encoding_dims` | index
| `source_size` | index
| `start_indices` | index
| `lengths` | index
| `result_encoding_dims` | index
| `result_size` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | resource or external resource or transient resource or variable resource or constant resource

#### `stream.tensor.splat` (Stream::TensorSplatOp)

_Splats a value into a shaped tensor_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.tensor.splat` (`on` `(` $affinity^ `)`)?
              $value
              `:` type($value)
              `-&gt;`
              $result_encoding (`` `{` $result_encoding_dims^ `}`)?
              `in`
              type($result) `` `{` $result_size `}`
              attr-dict-with-keyword
</code></pre></div>

Returns a typed resource initialized to the given primitive value.

Traits: AlwaysSpeculatableImplTrait, Stream_TensorPhaseOp

Interfaces: ConditionallySpeculatable, NoMemoryEffect (MemoryEffectOpInterface), Stream_AffinityOp, StreamableOpInterface, Util_ShapeAwareOp, Util_SizeAwareOp

Effects: MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>result_encoding</code></td><td>::mlir::TypeAttr</td><td>any type attribute</td></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `value` | index or integer or floating-point or complex-type
| `result_encoding_dims` | index
| `result_size` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | resource or external resource or transient resource or variable resource or constant resource

#### `stream.tensor.store` (Stream::TensorStoreOp)

_Stores a value into a tensor element_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.tensor.store` $value `,`
              $target (`[` $indices^ `]`)? `:`
              type($value)
              `-&gt;`
              $target_encoding (`` `{` $target_encoding_dims^ `}`)?
              `in`
              custom&lt;ShapedTiedResult&gt;(type($target), $target_size)
              attr-dict-with-keyword
</code></pre></div>

Returns a tensor with the element at the given index set to the given value.

Traits: AlwaysSpeculatableImplTrait, AttrSizedOperandSegments, Stream_TensorPhaseOp

Interfaces: ConditionallySpeculatable, InferTypeOpInterface, NoMemoryEffect (MemoryEffectOpInterface), TiedOpInterface, Util_ShapeAwareOp, Util_SizeAwareOp

Effects: MemoryEffects::Effect{}

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>target_encoding</code></td><td>::mlir::TypeAttr</td><td>any type attribute</td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `target` | staging resource
| `target_encoding_dims` | index
| `target_size` | index
| `indices` | index
| `value` | index or integer or floating-point or complex-type or vector of any type values

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | staging resource

#### `stream.tensor.trace` (Stream::TensorTraceOp)

_Trace value(s) operation_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.tensor.trace` attr-dict ($operands^ `:` type($operands))?
</code></pre></div>

Traces out to a runtime trace sink (console, log file, etc) the given
tensors and titles them with the given key. The key is informational only
and useful for titling/marking specific sets of tensors for easier
searching.

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>key</code></td><td>::mlir::StringAttr</td><td>string attribute</td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `operands` | tensor of any type values

#### `stream.tensor.update` (Stream::TensorUpdateOp)

_Updates a slice of a subview of a resource in-place_


Syntax:

<div class="highlight"><pre><span></span><code>operation ::= `stream.tensor.update` (`on` `(` $affinity^ `)`)?
              $update `,` $target `[` $start_indices `]` `:`
              $update_encoding (`` `{` $update_encoding_dims^ `}`)?
              `in`
              type($update) `` `{` $update_size `}`
              `-&gt;`
              $target_encoding (`` `{` $target_encoding_dims^ `}`)?
              `in`
              custom&lt;ShapedTiedResult&gt;(type($target), $target_size)
              attr-dict-with-keyword
</code></pre></div>

Copies a value into a resource based on tensor encodings. The returned value
is the entire updated target value.

Traits: AttrSizedOperandSegments, Stream_TensorPhaseOp

Interfaces: InferTypeOpInterface, Stream_AffinityOp, Stream_StreamableOp, TiedOpInterface, Util_ShapeAwareOp, Util_SizeAwareOp

##### Attributes:

<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>target_encoding</code></td><td>::mlir::TypeAttr</td><td>any type attribute</td></tr>
<tr><td><code>update_encoding</code></td><td>::mlir::TypeAttr</td><td>any type attribute</td></tr>
<tr><td><code>affinity</code></td><td>::mlir::iree_compiler::IREE::Stream::AffinityAttr</td><td><details><summary>defines execution context affinity</summary>{{% markdown %}}
    WIP; see [#10765](https://github.com/openxla/iree/issues/10765).

    TBD. The intent is that this can specify host, device, and queue affinity.
    Scopes can be annotated with an affinity to ensure execution within happens
    in a particular location. Arrays of affinities or wildcard specifiers will
    allow for refinement ("do it on this device but auto select a queue"). It
    will also allow us to indicate host affinity such that device<->device and
    host<->device can be identified in the IR structure. Today all affinities
    are no-op'ed and assumed to be 'current device'.
  {{% /markdown %}}</details></td></tr>
<table>

##### Operands:

| Operand | Description |
| :-----: | ----------- |
| `target` | resource or external resource or transient resource or variable resource or constant resource
| `target_encoding_dims` | index
| `target_size` | index
| `start_indices` | index
| `update` | resource or external resource or transient resource or variable resource or constant resource
| `update_encoding_dims` | index
| `update_size` | index

##### Results:

| Result | Description |
| :----: | ----------- |
| `result` | resource or external resource or transient resource or variable resource or constant resource


## Attribute definition

### CollectiveAttr

collective operation and specification

Syntax:

<div class="highlight"><pre><span></span><code>#stream.collective&lt;
  CollectiveKind,   # kind
  std::optional&lt;CollectiveReductionOp&gt;,   # reduction
  CollectiveElementType   # element_type
&gt;
</code></pre></div>

Specifies the collective operation to perform and any mode bits required.

##### Parameters:

| Parameter | C++ type | Description |
| :-------: | :-------: | ----------- |
| kind | `CollectiveKind` |  |
| reduction | `std::optional<CollectiveReductionOp>` |  |
| element_type | `CollectiveElementType` |  |

### PartitioningConfigAttr

defines partitioning configuration

Configures the partitioning algorithm to use and its configuration.
Partitioning is useful to adjust when scheduling behavior of targets is
radically different - such as single-threaded vs. multi-threaded CPUs or
bespoke ML accelerators vs. general purpose GPUs. This mechanism controls
the amount of concurrency, parallelism, memory consumption, and latency.

##### Parameters:

| Parameter | C++ type | Description |
| :-------: | :-------: | ----------- |
| favor | `IREE::Stream::FavorAttr` |  |

### ResourceConfigAttr

defines resource constraints configuration

Defines resource storage constraints. These allow for packing and layout
algorithms to ensure they are producing usable results on target devices.

##### Parameters:

| Parameter | C++ type | Description |
| :-------: | :-------: | ----------- |
| maxAllocationSize | `int64_t` |  |
| minBufferOffsetAlignment | `int64_t` |  |
| maxBufferRange | `int64_t` |  |
| minBufferRangeAlignment | `int64_t` |  |
| indexBits | `int64_t` |  |
| aliasMutableBindings | `bool` |  |

### TimepointAttr

an immediately-resolved timepoint


##### Parameters:

| Parameter | C++ type | Description |
| :-------: | :-------: | ----------- |
| type | `::mlir::Type` |  |

## Type constraint definition

### constant resource

Stream constants are immutable values that are available for the lifetime of
the program once initialized.


### external resource

Stream external values represent asynchronously-available and sequenced
values that are owned and managed by external code - such as those passed in
or out of the program entry points. Though external values are managed
during an invocation the same as other stream values the visibility into
them does not extend outside of the invocation they are provided to.

Stream values are not usable directly outside of a stream execution or
transfer operation. If the contents of the value are needed they must first
be transferred via `stream.transfer` - which may incur a copy.


### staging resource

Stream upload/download staging resource. These are used outside of streams
and then transferred to other stream resources such as variables or
transients for use inside of streams. Dispatches and several other
operations cannot directly operate on these resources.


### transient resource

Stream transients represent asynchronously-available and sequenced values
that have a short lifetime - often only passed between stream executions.
It is expected that transient values are not stored in global state and have
minimal lifetime as they may be heavily pooled or suballocated.

Stream values are not usable directly outside of a stream execution or
transfer operation. If the contents of the value are needed they must first
be transferred via `stream.transfer` - which may incur a copy.


### resource

A stream resource that has not yet had its lifetime calculated.


### variable resource

Stream variables represent asynchronously-available and sequenced values
that have a long lifetime relative to the work being performed on them.
These variables are often stored in global state and may live for the entire
duration of the program.

Stream values are not usable directly outside of a stream execution or
transfer operation. If the contents of the value are needed they must first
be transferred via `stream.transfer` - which may incur a copy.


## Type definition

### BindingType

a managed resource binding into an executable scope

Syntax: `!stream.binding`

A resource binding available within an executable dispatch function.
The bindings map 1:1 with the resources bound during dispatch operations.

### ChannelType

a collective communication channel

Syntax: `!stream.channel`

Represents a single participant in a collective clique. Multiple channels
may exist within the same program to allow for partial operations or
hierarchical operations.

In programs that model SPMD behavior internally channels can be created or
provided by hosting applications. For example, the program could expose a
`@set_channels(!util.list<!stream.channel>)` method that stores the channels
in globals for use throughout the program allowing for
application-controlled channel configuration.

### FileType

a file handle used for I/O operations

Syntax: `!stream.file`

A file handle that can be asynchronously read and written into/from
stream resources.

### ResourceType

a managed resource

Stream external values represent asynchronously-available and sequenced
values that are owned and managed by external code - such as those passed in
or out of the program entry points. Though external values are managed
during an invocation the same as other stream values the visibility into
them does not extend outside of the invocation they are provided to.

Stream values are not usable directly outside of a stream execution or
transfer operation. If the contents of the value are needed they must first
be transferred via `stream.transfer` - which may incur a copy.

##### Parameters:

| Parameter | C++ type | Description |
| :-------: | :-------: | ----------- |
| lifetime | `IREE::Stream::Lifetime` |  |

### TimepointType

a timepoint indicating execution availability

Syntax: `!stream.timepoint`

Represents a point in the execution timeline that when resolved indicates
that all of the execution prior to this timepoint has completed and the
results of the execution are available for use. This includes transitive
dependencies as well; if timepoint B is dependent on timepoint A then when
B is available so too must be A.





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 The IREE Authors
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/openxla/iree" target="_blank" rel="noopener" title="IREE on GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://discord.gg/26P4xW4" target="_blank" rel="noopener" title="IREE Discord Server" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.689 483.689 0 0 0-119.688 37.107 1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375 487.666 487.666 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251.047 251.047 0 0 0 9.109-7.137 1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233 234.533 234.533 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541ZM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241Zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241Z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://groups.google.com/forum/#!forum/iree-discuss" target="_blank" rel="noopener" title="IREE Discuss Google Group" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M144 0a80 80 0 1 1 0 160 80 80 0 1 1 0-160zm368 0a80 80 0 1 1 0 160 80 80 0 1 1 0-160zM0 298.7C0 239.8 47.8 192 106.7 192h42.7c15.9 0 31 3.5 44.6 9.7-1.3 7.2-1.9 14.7-1.9 22.3 0 38.2 16.8 72.5 43.3 96H21.3C9.6 320 0 310.4 0 298.7zM405.3 320h-.7c26.6-23.5 43.3-57.8 43.3-96 0-7.6-.7-15-1.9-22.3 13.6-6.3 28.7-9.7 44.6-9.7h42.7c58.9 0 106.7 47.8 106.7 106.7 0 11.8-9.6 21.3-21.3 21.3H405.3zM224 224a96 96 0 1 1 192 0 96 96 0 1 1-192 0zm-96 261.3c0-73.6 59.7-133.3 133.3-133.3h117.4c73.6 0 133.3 59.7 133.3 133.3 0 14.7-11.9 26.7-26.7 26.7H154.7c-14.7 0-26.7-11.9-26.7-26.7z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "content.code.copy", "content.tabs.link", "navigation.instant", "navigation.tracking", "navigation.sections", "navigation.expand", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.indexes", "toc.follow"], "search": "../../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.78eede0e.min.js"></script>
      
    
  </body>
</html>